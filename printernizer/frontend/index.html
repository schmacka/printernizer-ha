<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printernizer - 3D-Drucker Verwaltung</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/enhanced-metadata.css">
    <link rel="stylesheet" href="css/library.css">
    <link rel="stylesheet" href="css/materials.css">
    <link rel="stylesheet" href="css/timelapses.css">
    <link rel="stylesheet" href="css/search.css">
    <link rel="stylesheet" href="css/setup-wizard.css">
    <link rel="stylesheet" href="css/dark-theme.css">
    <link rel="stylesheet" href="css/themes/theme-industrial.css">
    <link rel="stylesheet" href="css/themes/theme-refined.css">
    <link rel="stylesheet" href="css/themes/theme-soft.css">
    <link rel="stylesheet" href="css/themes/theme-brutalist.css">
    <link rel="stylesheet" href="css/themes/theme-retro.css">
    <link rel="stylesheet" href="css/admin-statistics.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <!-- Logger must be loaded before theme-switcher -->
    <script src="js/logger.js"></script>
    <!-- Theme Switcher - Load early to prevent flash -->
    <script src="js/theme-switcher.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="assets/logo.png" alt="Printernizer" class="logo">
                <span class="brand-text">Printernizer</span>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Navigation umschalten" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
            <div class="nav-menu" role="navigation" aria-label="Hauptnavigation">
                <a href="#dashboard" class="nav-link active" data-page="dashboard" 
                   role="button" aria-current="page" aria-describedby="nav-dashboard-desc">
                    <span class="nav-icon" aria-hidden="true">üìä</span>
                    Dashboard
                </a>
                <a href="#printers" class="nav-link" data-page="printers" 
                   role="button" aria-describedby="nav-printers-desc">
                    <span class="nav-icon" aria-hidden="true">üñ®Ô∏è</span>
                    Drucker
                </a>
                <a href="#jobs" class="nav-link" data-page="jobs"
                   role="button" aria-describedby="nav-jobs-desc">
                    <span class="nav-icon" aria-hidden="true">‚öôÔ∏è</span>
                    Auftr√§ge
                </a>
                <a href="#timelapses" class="nav-link" data-page="timelapses"
                   role="button" aria-describedby="nav-timelapses-desc">
                    <span class="nav-icon" aria-hidden="true">üé¨</span>
                    Zeitraffer
                </a>
                <a href="#files" class="nav-link" data-page="files"
                   role="button" aria-describedby="nav-files-desc">
                    <span class="nav-icon" aria-hidden="true">üìÅ</span>
                    Dateien
                </a>
                <a href="#library" class="nav-link" data-page="library"
                   role="button" aria-describedby="nav-library-desc">
                    <span class="nav-icon" aria-hidden="true">üóÑÔ∏è</span>
                    Bibliothek
                </a>
                <a href="#materials" class="nav-link" data-page="materials"
                   role="button" aria-describedby="nav-materials-desc">
                    <span class="nav-icon" aria-hidden="true">üßµ</span>
                    Filamente
                </a>
                <a href="#ideas" class="nav-link" data-page="ideas"
                   role="button" aria-describedby="nav-ideas-desc">
                    <span class="nav-icon" aria-hidden="true">üí°</span>
                    Ideen
                </a>
                <a href="#settings" class="nav-link" data-page="settings"
                   role="button" aria-describedby="nav-settings-desc">
                    <span class="nav-icon" aria-hidden="true">‚öôÔ∏è</span>
                    Einstellungen
                </a>
                <a href="#debug" class="nav-link" data-page="debug" 
                   role="button" aria-describedby="nav-debug-desc">
                    <span class="nav-icon" aria-hidden="true">üêõ</span>
                    Debug
                </a>
            </div>
            <!-- Screen reader descriptions -->
            <div class="sr-only">
                <div id="nav-dashboard-desc">√úbersichtsseite mit Druckerstatus und aktuellen Auftr√§gen</div>
                <div id="nav-printers-desc">Verwaltung und Konfiguration der 3D-Drucker</div>
                <div id="nav-jobs-desc">√úbersicht und Verwaltung der Druckauftr√§ge</div>
                <div id="nav-files-desc">Dateiverwaltung und Downloads von den Druckern</div>
                <div id="nav-library-desc">Zentrale Bibliothek f√ºr alle 3D-Dateien mit Metadaten</div>
                <div id="nav-materials-desc">Filament-Verwaltung und Bestands√ºbersicht</div>
                <div id="nav-ideas-desc">Ideenverwaltung, Lesezeichen und Modell-Entdeckung</div>
                <div id="nav-settings-desc">Anwendungseinstellungen und Konfiguration</div>
                <div id="nav-debug-desc">Debug-Informationen und Systemprotokolle</div>
            </div>
            <div class="nav-status">
                <div class="connection-status" id="connectionStatus">
                    <div class="status-dot disconnected"></div>
                    <span class="status-text">Verbindung...</span>
                </div>
                <div class="support-button">
                    <a href="https://buymeacoffee.com/porcus3d" target="_blank" class="btn btn-support"
                       title="Unterst√ºtze die Entwicklung">
                        <span class="support-icon">‚òï</span><span class="support-text">Support</span>
                    </a>
                </div>
                <button id="themeToggle" class="theme-toggle" aria-label="Theme umschalten" title="Theme umschalten">
                    <span class="theme-icon" id="themeIcon">üåô</span>
                    <span class="theme-text" id="themeText">Dunkel</span>
                </button>
                <div class="system-time" id="systemTime"></div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h1>Dashboard</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshDashboard()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                </div>
            </div>

            <!-- System Overview Cards -->
            <div class="overview-cards">
                <div class="card overview-card">
                    <div class="card-header">
                        <h3>Drucker Status</h3>
                        <span class="card-icon">üñ®Ô∏è</span>
                    </div>
                    <div class="card-body">
                        <div class="stat-number" id="printerCount">-</div>
                        <div class="stat-label">Drucker Online</div>
                        <div class="stat-detail" id="printerDetail">Lade...</div>
                    </div>
                </div>

                <div class="card overview-card">
                    <div class="card-header">
                        <h3>Aktive Auftr√§ge</h3>
                        <span class="card-icon">‚öôÔ∏è</span>
                    </div>
                    <div class="card-body">
                        <div class="stat-number" id="activeJobsCount">-</div>
                        <div class="stat-label">Druckauftr√§ge</div>
                        <div class="stat-detail" id="jobsDetail">Lade...</div>
                    </div>
                </div>

                <div class="card overview-card">
                    <div class="card-header">
                        <h3>Dateien</h3>
                        <span class="card-icon">üìÅ</span>
                    </div>
                    <div class="card-body">
                        <div class="stat-number" id="filesCount">-</div>
                        <div class="stat-label">Verf√ºgbare Dateien</div>
                        <div class="stat-detail" id="filesDetail">Lade...</div>
                    </div>
                </div>

                <div class="card overview-card">
                    <div class="card-header">
                        <h3>Heute</h3>
                        <span class="card-icon">üìà</span>
                    </div>
                    <div class="card-body">
                        <div class="stat-number" id="todayJobsCount">-</div>
                        <div class="stat-label">Auftr√§ge heute</div>
                        <div class="stat-detail" id="todayDetail">Lade...</div>
                    </div>
                </div>
            </div>

            <!-- Printer Status Cards -->
            <div class="section">
                <div class="section-header">
                    <h2>Drucker Status</h2>
                    <button class="btn btn-primary" id="addPrinterBtnDashboard" data-action="add-printer" onclick="showAddPrinter()">
                        <span class="btn-icon">‚ûï</span>
                        Drucker hinzuf√ºgen
                    </button>
                </div>
                <div class="printer-grid" id="printerGrid">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Drucker...</p>
                    </div>
                </div>
            </div>

            <!-- Recent Jobs -->
            <div class="section">
                <div class="section-header">
                    <h2>Aktuelle Auftr√§ge</h2>
                    <a href="#jobs" class="btn btn-secondary" onclick="showPage('jobs')">
                        Alle anzeigen
                    </a>
                </div>
                <div class="jobs-preview" id="recentJobs">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Auftr√§ge...</p>
                    </div>
                </div>
            </div>

            <!-- Recent Printed Files -->
            <div class="section">
                <div class="section-header">
                    <h2>K√ºrzlich gedruckte Dateien</h2>
                    <a href="#files" class="btn btn-secondary" onclick="showPage('files')">
                        Alle anzeigen
                    </a>
                </div>
                <div class="printed-files-preview" id="recentPrintedFiles">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade gedruckte Dateien...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Printers Page -->
        <div id="printers" class="page">
            <div class="page-header">
                <h1>Drucker Verwaltung</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="discoverPrinters()" id="discoverButton">
                        <span class="btn-icon">üîç</span>
                        Drucker suchen
                    </button>
                    <button class="btn btn-primary" id="addPrinterBtn" data-action="add-printer" onclick="showAddPrinter()">
                        <span class="btn-icon">‚ûï</span>
                        Drucker hinzuf√ºgen
                    </button>
                </div>
            </div>

            <!-- Discovered Printers Section -->
            <div id="discoveredPrintersSection" class="section" style="display: none;">
                <div class="section-header">
                    <h2>Gefundene Drucker</h2>
                    <div class="header-actions">
                        <select id="networkInterfaceSelect" class="form-select" style="margin-right: 10px;">
                            <option value="">Auto-Erkennung</option>
                        </select>
                        <button class="btn btn-secondary btn-sm" onclick="discoverPrinters()">
                            <span class="btn-icon">üîÑ</span>
                            Erneut suchen
                        </button>
                    </div>
                </div>
                <div class="discovered-printers-list" id="discoveredPrintersList">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Suche nach Druckern im Netzwerk...</p>
                    </div>
                </div>
            </div>

            <div class="printers-container">
                <div class="section-header">
                    <h2>Konfigurierte Drucker</h2>
                </div>
                <div class="printers-list" id="printersList">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Drucker...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Jobs Page -->
        <div id="page-jobs" class="page">
            <div class="page-header">
                <h1>Druckauftr√§ge</h1>
                <div class="header-actions">
                    <div class="filter-controls">
                        <select id="jobStatusFilter" class="filter-select">
                            <option value="">Alle Status</option>
                            <option value="printing">Druckt</option>
                            <option value="queued">Warteschlange</option>
                            <option value="completed">Abgeschlossen</option>
                            <option value="failed">Fehlgeschlagen</option>
                            <option value="cancelled">Abgebrochen</option>
                        </select>
                        <select id="jobPrinterFilter" class="filter-select">
                            <option value="">Alle Drucker</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="openPageSettings('jobs', 'Druckauftr√§ge')">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Einstellungen
                    </button>
                    <button class="btn btn-secondary" onclick="refreshJobs()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                    <button class="btn btn-primary" id="createJobBtn" onclick="showCreateJobModal()">
                        <span class="btn-icon">‚ûï</span>
                        Create Job
                    </button>
                </div>
            </div>

            <div class="jobs-container">
                <table class="jobs-table" id="jobsTable" style="width: 100%; display: table;">
                    <thead>
                        <tr>
                            <th>Auftrag</th>
                            <th>Drucker</th>
                            <th>Status</th>
                            <th>Datei</th>
                            <th>Fortschritt</th>
                            <th>Aktionen</th>
                        </tr>
                    </thead>
                    <tbody id="jobsTableBody">
                        <tr>
                            <td colspan="6" class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade Auftr√§ge...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="jobs-list" id="jobsList" style="display: none;">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Auftr√§ge...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timelapses Page -->
        <div id="timelapses" class="page">
            <div class="page-header">
                <h1>Zeitraffer-Videos</h1>
                <div class="header-actions">
                    <div class="filter-controls">
                        <select id="timelapseStatusFilter" class="filter-select">
                            <option value="">Alle Status</option>
                            <option value="discovered">Entdeckt</option>
                            <option value="pending">Wartend</option>
                            <option value="processing">Verarbeitung</option>
                            <option value="completed">Fertig</option>
                            <option value="failed">Fehlgeschlagen</option>
                        </select>
                        <label class="filter-checkbox">
                            <input type="checkbox" id="timelapseLinkedOnly">
                            <span>Nur verkn√ºpfte</span>
                        </label>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="openPageSettings('timelapse', 'Zeitraffer-Videos')">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Einstellungen
                    </button>
                    <button class="btn btn-secondary" onclick="refreshTimelapses()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                </div>
            </div>

            <!-- Stats Bar -->
            <div id="timelapseStats" class="stats-bar">
                <div class="stat-item">
                    <span class="stat-label">Gesamt:</span>
                    <span class="stat-value" id="statTotalVideos">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Verarbeitung:</span>
                    <span class="stat-value" id="statProcessing">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Fertig:</span>
                    <span class="stat-value" id="statCompleted">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Speicher:</span>
                    <span class="stat-value" id="statStorageSize">0 MB</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Bereinigung:</span>
                    <span class="stat-value" id="statCleanupCandidates">0</span>
                </div>
            </div>

            <!-- Processing Queue Status (shown when processing) -->
            <div id="processingQueue" class="processing-queue" style="display: none;">
                <div class="queue-header">
                    <span class="queue-icon">‚öôÔ∏è</span>
                    <span class="queue-title">Verarbeitung l√§uft...</span>
                </div>
                <div id="queueItem" class="queue-item"></div>
            </div>

            <!-- Timelapses Gallery -->
            <div class="timelapses-container">
                <div class="timelapses-grid" id="timelapsesList">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Zeitraffer-Videos...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Files Page -->
        <div id="files" class="page">
            <div class="page-header">
                <h1>Drucker-Dateien</h1>
                <div class="header-actions">
                    <div class="search-controls">
                        <div class="search-input-wrapper">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="fileSearchInput" class="search-input"
                                   placeholder="Nach Dateinamen suchen..."
                                   autocomplete="off"
                                   aria-label="Nach Dateinamen suchen">
                            <button class="search-clear-btn" id="fileSearchClear"
                                    onclick="clearFileSearch()"
                                    style="display: none;"
                                    aria-label="Suche l√∂schen">‚úï</button>
                        </div>
                    </div>
                    <div class="filter-controls">
                        <select id="fileStatusFilter" class="filter-select">
                            <option value="">Alle Status</option>
                            <option value="available">üìÅ Verf√ºgbar</option>
                            <option value="downloaded">‚úì Heruntergeladen</option>
                            <option value="local">üíæ Lokal</option>
                        </select>
                        <select id="filePrinterFilter" class="filter-select">
                            <option value="">Alle Drucker</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="openPageSettings('files', 'Drucker-Dateien')">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Einstellungen
                    </button>
                    <button class="btn btn-secondary" onclick="refreshFiles()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                </div>
            </div>

            <div class="files-stats" id="filesStats">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>Lade Dateien-Statistiken...</p>
                </div>
            </div>

            <!-- Watch Folders Section -->
            <div class="section">
                <div class="section-header">
                    <h2>√úberwachte Verzeichnisse</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="refreshWatchFolders()">
                            <span class="btn-icon">üîÑ</span>
                            Aktualisieren
                        </button>
                        <button class="btn btn-primary" onclick="showAddWatchFolderDialog()">
                            <span class="btn-icon">üìÇ</span>
                            Verzeichnis hinzuf√ºgen
                        </button>
                    </div>
                </div>
                <div class="watch-folders-container" id="watchFoldersContainer">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade √ºberwachte Verzeichnisse...</p>
                    </div>
                </div>
            </div>

            <!-- Discovered Files Section -->
            <div class="discovered-files-section">
                <div class="section-header">
                    <h2>
                        <span class="section-icon">üìÅ</span>
                        Entdeckte Dateien
                    </h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="loadDiscoveredFiles()">
                            <span class="btn-icon">üîÑ</span>
                            Aktualisieren
                        </button>
                    </div>
                </div>
                <div class="discovered-files-container" id="discoveredFilesContainer">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade entdeckte Dateien...</p>
                    </div>
                </div>
            </div>

            <div class="files-container">
                <div class="files-list" id="filesList">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Dateien...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Library Page -->
        <div id="library" class="page">
            <div class="page-header">
                <h1>üóÑÔ∏è Bibliothek</h1>
                <div class="header-subtitle">Zentrale Dateiverwaltung mit Metadaten und Quellenverfolgung</div>
                <div class="header-actions">
                    <div class="search-controls">
                        <div class="search-input-wrapper">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="librarySearchInput" class="search-input"
                                   placeholder="Nach Dateinamen suchen..."
                                   autocomplete="off"
                                   aria-label="Suche in Bibliothek">
                            <button class="search-clear-btn" id="librarySearchClear"
                                    onclick="clearLibrarySearch()"
                                    style="display: none;"
                                    aria-label="Suche l√∂schen">‚úï</button>
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="openPageSettings('library', 'Bibliothek')">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Einstellungen
                    </button>
                    <button class="btn btn-primary" onclick="triggerFileUpload()">
                        <span class="btn-icon">üì§</span>
                        Hochladen
                    </button>
                    <button class="btn btn-secondary" onclick="refreshLibrary()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                </div>
            </div>

            <!-- Hidden file input for manual upload -->
            <!-- iOS-friendly: simplified accept attribute for better mobile compatibility -->
            <input type="file"
                   id="libraryFileInput"
                   style="display: none;"
                   multiple
                   accept="*/*"
                   onchange="handleManualFileUpload(event)">

            <!-- Library Statistics -->
            <div class="library-stats-container" id="libraryStats">
                <div class="stat-card">
                    <div class="stat-value" id="statTotalFiles">--</div>
                    <div class="stat-label">Dateien</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTotalSize">--</div>
                    <div class="stat-label">Gesamt</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statWithThumbnails">--</div>
                    <div class="stat-label">Mit Vorschau</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statAnalyzed">--</div>
                    <div class="stat-label">Analysiert</div>
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <label for="filterSourceType">Quelle:</label>
                    <select id="filterSourceType" class="filter-select" onchange="applyLibraryFilters()">
                        <option value="">Alle</option>
                        <option value="printer">üñ®Ô∏è Drucker</option>
                        <option value="watch_folder">üìÅ √úberwacht</option>
                        <option value="upload">‚¨ÜÔ∏è Hochgeladen</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterFileType">Typ:</label>
                    <select id="filterFileType" class="filter-select" onchange="applyLibraryFilters()">
                        <option value="">Alle Dateitypen</option>
                        <option value=".3mf">.3MF</option>
                        <option value=".stl">.STL</option>
                        <option value=".gcode">.GCODE</option>
                        <option value=".obj">.OBJ</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterStatus">Status:</label>
                    <select id="filterStatus" class="filter-select" onchange="applyLibraryFilters()">
                        <option value="">Alle Status</option>
                        <option value="available">‚úÖ Verf√ºgbar</option>
                        <option value="processing">‚è≥ Verarbeitung</option>
                        <option value="ready">‚úì Bereit</option>
                        <option value="error">‚ùå Fehler</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterMetadata">Metadaten:</label>
                    <select id="filterMetadata" class="filter-select" onchange="applyLibraryFilters()">
                        <option value="">Alle</option>
                        <option value="has_thumbnail">üñºÔ∏è Mit Vorschau</option>
                        <option value="has_metadata">üìä Mit Metadaten</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterTag">Tag:</label>
                    <select id="filterTag" class="filter-select" onchange="applyLibraryFilters()">
                        <option value="">üè∑Ô∏è Alle Tags</option>
                        <!-- Dynamically populated by TagsManager -->
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sortBy">Sortierung:</label>
                    <select id="sortBy" class="filter-select">
                        <option value="created_at:desc">Neueste zuerst</option>
                        <option value="created_at:asc">√Ñlteste zuerst</option>
                        <option value="filename:asc">Name (A-Z)</option>
                        <option value="filename:desc">Name (Z-A)</option>
                        <option value="file_size:desc">Gr√∂√üe (gro√ü‚Üíklein)</option>
                        <option value="file_size:asc">Gr√∂√üe (klein‚Üígro√ü)</option>
                        <option value="last_modified:desc">Zuletzt ge√§ndert (neu‚Üíalt)</option>
                        <option value="last_modified:asc">Zuletzt ge√§ndert (alt‚Üíneu)</option>
                    </select>
                </div>
            </div>

            <!-- Library Files Grid -->
            <div class="library-container">
                <div class="library-files-grid" id="libraryFilesGrid">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Bibliothek...</p>
                    </div>
                </div>
            </div>

            <!-- Pagination Controls -->
            <div class="pagination-container">
                <div class="page-size-selector">
                    <label for="pageSizeSelect">Dateien pro Seite:</label>
                    <select id="pageSizeSelect">
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                        <option value="200">200</option>
                    </select>
                </div>

                <div class="pagination-info">
                    <span id="paginationInfo">0-0 von 0</span>
                </div>

                <div class="pagination-controls">
                    <button id="prevPageBtn" disabled>
                        ‚Üê Vorherige
                    </button>
                    <span id="currentPageInfo">Seite 1 von 1</span>
                    <button id="nextPageBtn" disabled>
                        N√§chste ‚Üí
                    </button>
                </div>
            </div>

        </div>

        <!-- Materials Page -->
        <div id="page-materials" class="page">
            <div class="page-header">
                <h1>üßµ Filament-Verwaltung</h1>
                <div class="header-subtitle">Bestandsverwaltung und Verbrauchstracking</div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="materialsManager.loadMaterials()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                    <button class="btn btn-primary" id="addMaterialBtn" onclick="materialsManager.showAddMaterialModal()">
                        <span class="btn-icon">‚ûï</span>
                        Filament hinzuf√ºgen
                    </button>
                </div>
            </div>

            <!-- Materials Statistics -->
            <div class="materials-stats-container" id="materialsStats">
                <div class="stat-card">
                    <div class="stat-value" id="statTotalSpools">--</div>
                    <div class="stat-label">Spulen</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTotalWeight">--</div>
                    <div class="stat-label">Gesamt (kg)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statLowStock">--</div>
                    <div class="stat-label">Niedrig</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTotalValue">--</div>
                    <div class="stat-label">Wert (‚Ç¨)</div>
                </div>
            </div>

            <!-- Filter and Search Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <label for="filterMaterialType">Typ:</label>
                    <select id="filterMaterialType" class="filter-select" onchange="materialsManager.applyFilters()">
                        <option value="">Alle Typen</option>
                        <!-- Populated by JS -->
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterMaterialBrand">Marke:</label>
                    <select id="filterMaterialBrand" class="filter-select" onchange="materialsManager.applyFilters()">
                        <option value="">Alle Marken</option>
                        <!-- Populated by JS -->
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterMaterialColor">Farbe:</label>
                    <select id="filterMaterialColor" class="filter-select" onchange="materialsManager.applyFilters()">
                        <option value="">Alle Farben</option>
                        <!-- Populated by JS -->
                    </select>
                </div>
                <div class="filter-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="filterLowStock" onchange="materialsManager.applyFilters()">
                        <span class="checkbox-custom"></span>
                        Nur niedrige Best√§nde
                    </label>
                </div>
                <div class="filter-group search-group">
                    <div class="search-input-wrapper">
                        <span class="search-icon">üîç</span>
                        <input type="text" id="materialSearchInput" class="search-input"
                               placeholder="Suchen..."
                               autocomplete="off"
                               oninput="materialsManager.applyFilters()"
                               aria-label="Nach Material suchen">
                        <button class="search-clear-btn" id="materialSearchClear"
                                onclick="materialsManager.clearSearch()"
                                style="display: none;"
                                aria-label="Suche l√∂schen">‚úï</button>
                    </div>
                </div>
            </div>

            <!-- View Mode Toggle -->
            <div class="view-controls">
                <div class="view-mode-toggle">
                    <button class="btn btn-small" id="cardsViewBtn" onclick="materialsManager.setViewMode('cards')">
                        <span class="btn-icon">‚äû</span>
                        Karten
                    </button>
                    <button class="btn btn-small" id="tableViewBtn" onclick="materialsManager.setViewMode('table')">
                        <span class="btn-icon">‚ò∞</span>
                        Tabelle
                    </button>
                </div>
                <div class="sort-controls">
                    <label for="sortMaterialsBy">Sortierung:</label>
                    <select id="sortMaterialsBy" class="filter-select" onchange="materialsManager.setSorting()">
                        <option value="created_at:desc">Neueste zuerst</option>
                        <option value="created_at:asc">√Ñlteste zuerst</option>
                        <option value="name:asc">Name (A-Z)</option>
                        <option value="name:desc">Name (Z-A)</option>
                        <option value="remaining_weight:asc">Bestand (niedrig‚Üíhoch)</option>
                        <option value="remaining_weight:desc">Bestand (hoch‚Üíniedrig)</option>
                        <option value="price_per_kg:asc">Preis (niedrig‚Üíhoch)</option>
                        <option value="price_per_kg:desc">Preis (hoch‚Üíniedrig)</option>
                    </select>
                </div>
            </div>

            <!-- Materials Container -->
            <div class="materials-container">
                <div id="materialsCardsView" class="materials-cards-grid" style="display: none;">
                    <div class="loading-placeholder">
                        <div class="spinner"></div>
                        <p>Lade Filamente...</p>
                    </div>
                </div>
                <div id="materialsTableView" class="materials-table-wrapper">
                    <table class="materials-table" id="materialsTable">
                        <thead>
                            <tr>
                                <th>Typ</th>
                                <th>Marke</th>
                                <th>Farbe</th>
                                <th>Bestand</th>
                                <th>Gewicht</th>
                                <th>Preis/kg</th>
                                <th>Wert</th>
                                <th>Standort</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="materialsTableBody">
                            <tr>
                                <td colspan="9" class="loading-placeholder">
                                    <div class="spinner"></div>
                                    <p>Lade Filamente...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- File Detail Modal -->
        <div id="fileDetailModal" class="modal">
            <div class="modal-content">
                <button id="closeFileDetailModal" class="modal-close">‚úï</button>
                <div id="fileDetailContent">
                    <div class="loading">L√§dt...</div>
                </div>
            </div>
        </div>

        <!-- Ideas Page -->
        <div id="ideas" class="page">
            <div class="page-header">
                <h1>Ideen</h1>
                <div class="header-actions">
                    <div class="filter-controls">
                        <select id="ideaStatusFilter" class="filter-select">
                            <option value="">Alle Status</option>
                            <option value="idea">üí° Idee</option>
                            <option value="planned">üìÖ Geplant</option>
                            <option value="printing">üñ®Ô∏è Wird gedruckt</option>
                            <option value="completed">‚úÖ Abgeschlossen</option>
                            <option value="archived">üì¶ Archiviert</option>
                        </select>
                        <select id="ideaTypeFilter" class="filter-select">
                            <option value="">Alle Typen</option>
                            <option value="business">üè¢ Gesch√§ftlich</option>
                            <option value="personal">üë§ Privat</option>
                        </select>
                        <select id="ideaSourceFilter" class="filter-select">
                            <option value="">Alle Quellen</option>
                            <option value="manual">‚úçÔ∏è Manuell</option>
                            <option value="makerworld">üåç Makerworld</option>
                            <option value="printables">üîß Printables</option>
                        </select>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="refreshIdeas()">
                            <span class="btn-icon">üîÑ</span>
                            Aktualisieren
                        </button>
                        <button class="btn btn-secondary" onclick="showImportDialog()">
                            <span class="btn-icon">üîó</span>
                            Aus URL importieren
                        </button>
                        <button class="btn btn-primary" onclick="showAddIdeaDialog()">
                            <span class="btn-icon">‚ûï</span>
                            Neue Idee
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ideas Navigation Tabs -->
            <div class="ideas-nav-tabs">
                <button class="tab-button active" data-tab="my-ideas" onclick="showIdeasTab('my-ideas')">
                    <span class="tab-icon">üí°</span>
                    Meine Ideen
                </button>
                <button class="tab-button" data-tab="bookmarks" onclick="showIdeasTab('bookmarks')">
                    <span class="tab-icon">üîñ</span>
                    Lesezeichen
                </button>
                <button class="tab-button" data-tab="trending" onclick="showIdeasTab('trending')">
                    <span class="tab-icon">üìà</span>
                    Trending
                </button>
            </div>

            <!-- Ideas Statistics -->
            <div class="ideas-stats" id="ideasStats">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>Lade Ideen-Statistiken...</p>
                </div>
            </div>

            <!-- My Ideas Tab -->
            <div id="my-ideas-tab" class="ideas-tab-content active">
                <div class="section">
                    <div class="section-header">
                        <h2>
                            <span class="section-icon">üí°</span>
                            Meine Ideen
                        </h2>
                        <div class="ideas-view-controls">
                            <button class="btn btn-small" onclick="setIdeasView('grid')" id="gridViewBtn">
                                <span class="btn-icon">‚äû</span>
                                Raster
                            </button>
                            <button class="btn btn-small" onclick="setIdeasView('list')" id="listViewBtn">
                                <span class="btn-icon">‚ò∞</span>
                                Liste
                            </button>
                        </div>
                    </div>
                    <div class="ideas-container" id="myIdeasContainer">
                        <div class="loading-placeholder">
                            <div class="spinner"></div>
                            <p>Lade Ideen...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bookmarks Tab -->
            <div id="bookmarks-tab" class="ideas-tab-content">
                <div class="section">
                    <div class="section-header">
                        <h2>
                            <span class="section-icon">üîñ</span>
                            Lesezeichen
                        </h2>
                        <div class="header-actions">
                            <button class="btn btn-secondary" onclick="showImportDialog('bookmarks')">
                                <span class="btn-icon">üîó</span>
                                Aus URL importieren
                            </button>
                        </div>
                    </div>
                    <div class="platform-filter">
                        <button class="platform-btn active" data-platform="all" onclick="filterBookmarksByPlatform('all')">
                            Alle
                        </button>
                        <button class="platform-btn" data-platform="makerworld" onclick="filterBookmarksByPlatform('makerworld')">
                            Makerworld
                        </button>
                        <button class="platform-btn" data-platform="printables" onclick="filterBookmarksByPlatform('printables')">
                            Printables
                        </button>
                    </div>
                    <div class="bookmarks-container" id="bookmarksContainer">
                        <div class="loading-placeholder">
                            <div class="spinner"></div>
                            <p>Lade Lesezeichen...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trending Tab -->
            <div id="trending-tab" class="ideas-tab-content">
                <div class="section">
                    <div class="section-header">
                        <h2>
                            <span class="section-icon">üìà</span>
                            Trending Modelle
                        </h2>
                        <div class="header-actions">
                            <div class="trending-platform-filter">
                                <button class="platform-btn active" data-platform="all" onclick="filterTrendingByPlatform('all')">
                                    Alle
                                </button>
                                <button class="platform-btn" data-platform="makerworld" onclick="filterTrendingByPlatform('makerworld')">
                                    Makerworld
                                </button>
                                <button class="platform-btn" data-platform="printables" onclick="filterTrendingByPlatform('printables')">
                                    Printables
                                </button>
                            </div>
                            <button class="btn btn-secondary" onclick="refreshTrending()">
                                <span class="btn-icon">üîÑ</span>
                                Aktualisieren
                            </button>
                        </div>
                    </div>
                    <div class="trending-container" id="trendingContainer">
                        <div class="loading-placeholder">
                            <div class="spinner"></div>
                            <p>Lade Trending-Modelle...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings" class="page">
            <!-- Settings Breadcrumb -->
            <div id="settingsBreadcrumb" class="settings-breadcrumb" style="display: none;">
                <button class="breadcrumb-back" onclick="navigateBackFromSettings()">
                    ‚Üê Zur√ºck
                </button>
            </div>

            <div class="page-header">
                <h1>‚öôÔ∏è Einstellungen</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="settingsManager.exportSettings()">
                        <span class="btn-icon">üì§</span>
                        Exportieren
                    </button>
                    <button class="btn btn-secondary" onclick="settingsManager.importSettings()">
                        <span class="btn-icon">üì•</span>
                        Importieren
                    </button>
                    <button class="btn btn-secondary" onclick="loadSettings()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                    <button class="btn btn-primary" onclick="saveSettings()">
                        <span class="btn-icon">üíæ</span>
                        Speichern
                    </button>
                </div>
            </div>

            <!-- Settings Search -->
            <div class="settings-search-container" style="margin: 0 2rem 1.5rem 2rem;">
                <input type="text" id="settingsSearch" class="form-control" placeholder="üîç Einstellungen durchsuchen..."
                       oninput="settingsManager.filterSettings(this.value)" style="max-width: 400px;">
            </div>

            <!-- Settings Tabs -->
            <div class="settings-tabs-container">
                <div class="settings-tabs">
                    <button class="settings-tab active" data-tab="general" onclick="settingsManager.switchTab('general')">
                        <span class="tab-icon">‚öôÔ∏è</span>
                        <span class="tab-label">Allgemein</span>
                    </button>
                    <button class="settings-tab" data-tab="jobs" onclick="settingsManager.switchTab('jobs')">
                        <span class="tab-icon">üñ®Ô∏è</span>
                        <span class="tab-label">Auftr√§ge & G-Code</span>
                    </button>
                    <button class="settings-tab" data-tab="library" onclick="settingsManager.switchTab('library')">
                        <span class="tab-icon">üóÑÔ∏è</span>
                        <span class="tab-label">Bibliothek</span>
                    </button>
                    <button class="settings-tab" data-tab="files" onclick="settingsManager.switchTab('files')">
                        <span class="tab-icon">üìÅ</span>
                        <span class="tab-label">Uploads & Downloads</span>
                    </button>
                    <button class="settings-tab" data-tab="timelapse" onclick="settingsManager.switchTab('timelapse')">
                        <span class="tab-icon">üé¨</span>
                        <span class="tab-label">Timelapse</span>
                    </button>
                    <button class="settings-tab" data-tab="watch" onclick="settingsManager.switchTab('watch')">
                        <span class="tab-icon">üëÅÔ∏è</span>
                        <span class="tab-label">√úberwachung</span>
                    </button>
                    <button class="settings-tab" data-tab="system" onclick="settingsManager.switchTab('system')">
                        <span class="tab-icon">üíª</span>
                        <span class="tab-label">System</span>
                    </button>
                    <button class="settings-tab" data-tab="privacy" onclick="settingsManager.switchTab('privacy')">
                        <span class="tab-icon">üîí</span>
                        <span class="tab-label">Datenschutz</span>
                    </button>
                    <button class="settings-tab" data-tab="notifications" onclick="settingsManager.switchTab('notifications')">
                        <span class="tab-icon">üîî</span>
                        <span class="tab-label">Notifications</span>
                    </button>
                    <button class="settings-tab" data-tab="appearance" onclick="settingsManager.switchTab('appearance')">
                        <span class="tab-icon">üé®</span>
                        <span class="tab-label">Appearance</span>
                    </button>
                </div>

                <div class="settings-tab-content">
                    <!-- General Settings Tab -->
                    <div class="tab-pane active" id="general-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>‚öôÔ∏è Allgemeine Einstellungen</h3>
                            </div>
                            <div class="card-body">
                                <form id="applicationSettingsForm" class="settings-form">
                                    <div class="form-group">
                                        <label for="logLevel">Log-Level üìã</label>
                                        <select id="logLevel" name="log_level" class="form-control">
                                            <option value="DEBUG">Debug</option>
                                            <option value="INFO">Info</option>
                                            <option value="WARNING">Warning</option>
                                            <option value="ERROR">Error</option>
                                        </select>
                                        <small class="form-text text-muted">Detailgrad der Protokollierung</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="monitoringInterval">√úberwachungsintervall (Sekunden) ‚è±Ô∏è</label>
                                        <input type="number" id="monitoringInterval" name="monitoring_interval"
                                               class="form-control" min="5" max="300" step="5">
                                        <small class="form-text text-muted">Intervall f√ºr Druckerstatusabfragen (5-300 Sekunden)</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="connectionTimeout">Verbindungs-Timeout (Sekunden) ‚è≥</label>
                                        <input type="number" id="connectionTimeout" name="connection_timeout"
                                               class="form-control" min="5" max="60" step="1">
                                        <small class="form-text text-muted">Maximale Wartezeit f√ºr Verbindungen (5-60 Sekunden)</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="vatRate">MwSt.-Satz (%) üí∞</label>
                                        <input type="number" id="vatRate" name="vat_rate"
                                               class="form-control" min="0" max="50" step="0.1">
                                        <small class="form-text text-muted">Mehrwertsteuersatz f√ºr Kostenberechnungen</small>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Jobs & G-Code Tab -->
                    <div class="tab-pane" id="jobs-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üñ®Ô∏è Auftrags-Verwaltung</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="jobCreationAutoCreate" name="job_creation_auto_create" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Automatische Auftrags-Erstellung ‚ö°
                                        </label>
                                        <small class="form-text text-muted">
                                            Auftr√§ge automatisch erstellen, wenn ein Druck startet oder beim Start entdeckt wird
                                        </small>
                                        <div class="alert alert-info mt-2">
                                            <strong>‚ö° Auto-Jobs:</strong> Auftr√§ge mit <span class="status-badge badge-auto" style="font-size: 0.75rem; padding: 2px 6px;">‚ö° Auto</span> Badge wurden automatisch erstellt.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üé® G-Code Optimierung</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="gcodeOptimizePrintOnly" name="gcode_optimize_print_only" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Nur Druck-Bewegungen anzeigen üéØ
                                        </label>
                                        <small class="form-text text-muted">
                                            Filtert Leerfahrten aus der G-Code-Vorschau f√ºr bessere √úbersicht
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="gcodeOptimizationMaxLines">Max. Zeilen f√ºr Optimierung üìè</label>
                                        <input type="number" id="gcodeOptimizationMaxLines" name="gcode_optimization_max_lines"
                                               class="form-control" min="100" max="100000" step="100" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Maximale Anzahl G-Code-Zeilen zur Verarbeitung (100-100.000)</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="gcodeRenderMaxLines">Max. Zeilen f√ºr Rendering üé¨</label>
                                        <input type="number" id="gcodeRenderMaxLines" name="gcode_render_max_lines"
                                               class="form-control" min="100" max="1000000" step="1000" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Maximale Anzahl Zeilen f√ºr 3D-Vorschau (100-1.000.000)</small>
                                    </div>

                                    <div class="alert alert-info">
                                        <strong>üí° Tipp:</strong> H√∂here Werte bedeuten genauere Vorschau, aber langsamere Performance.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Library Tab -->
                    <div class="tab-pane" id="library-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üóÑÔ∏è Bibliothek-System</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="libraryEnabled" name="library_enabled" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Bibliothek-System aktivieren ‚úÖ
                                        </label>
                                        <small class="form-text text-muted">
                                            Automatische Dateiverwaltung mit Deduplizierung und Metadaten
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="libraryPath">Bibliothek-Pfad üìÇ</label>
                                        <input type="text" id="libraryPath" name="library_path"
                                               class="form-control" form="applicationSettingsForm"
                                               placeholder="z.B. C:\3DLibrary oder ./data/library">
                                        <small class="form-text text-muted">
                                            Verzeichnis f√ºr die zentrale Datei-Bibliothek (absolut oder relativ)
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <div class="validation-result" id="libraryPathValidationResult" style="display: none;"></div>
                                    </div>

                                    <div class="form-group">
                                        <button type="button" class="btn btn-secondary" onclick="validateLibraryPath()">
                                            <span class="btn-icon">‚úì</span>
                                            Pfad validieren
                                        </button>
                                    </div>

                                    <div class="alert alert-warning">
                                        <strong>‚ö†Ô∏è Hinweis:</strong> Nach √Ñnderung des Bibliothek-Pfads ist ein Neustart erforderlich.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>‚öôÔ∏è Automatisierung</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="libraryAutoOrganize" name="library_auto_organize" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Automatische Organisation üìã
                                        </label>
                                        <small class="form-text text-muted">
                                            Dateien aus √ºberwachten Ordnern und Downloads automatisch zur Bibliothek hinzuf√ºgen
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="libraryAutoExtractMetadata" name="library_auto_extract_metadata" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Automatische Metadaten-Extraktion üè∑Ô∏è
                                        </label>
                                        <small class="form-text text-muted">
                                            Druckeinstellungen und Modell-Informationen automatisch aus Dateien auslesen
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="libraryAutoDeduplicate" name="library_auto_deduplicate" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Automatische Deduplizierung üîç
                                        </label>
                                        <small class="form-text text-muted">
                                            Doppelte Dateien anhand ihres Inhalts erkennen und zusammenf√ºhren
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="libraryPreserveOriginals" name="library_preserve_originals" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Originaldateien bewahren üíæ
                                        </label>
                                        <small class="form-text text-muted">
                                            Originaldateien nicht l√∂schen, nur kopieren
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üîß Erweiterte Einstellungen</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label for="libraryChecksumAlgorithm">Pr√ºfsummen-Algorithmus üîê</label>
                                        <select id="libraryChecksumAlgorithm" name="library_checksum_algorithm" class="form-control" form="applicationSettingsForm">
                                            <option value="sha256">SHA-256 (Standard)</option>
                                            <option value="md5">MD5 (Schneller)</option>
                                            <option value="sha1">SHA-1</option>
                                        </select>
                                        <small class="form-text text-muted">Algorithmus zur Erkennung doppelter Dateien</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="libraryProcessingWorkers">Verarbeitungs-Threads üîÑ</label>
                                        <input type="number" id="libraryProcessingWorkers" name="library_processing_workers"
                                               class="form-control" min="1" max="16" step="1" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Anzahl paralleler Threads f√ºr Dateiverarbeitung (1-16)</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="librarySearchEnabled" name="library_search_enabled" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Suchfunktion aktivieren üîé
                                        </label>
                                        <small class="form-text text-muted">
                                            Volltextsuche in Bibliothek aktivieren
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="librarySearchMinLength">Minimale Suchl√§nge üìè</label>
                                        <input type="number" id="librarySearchMinLength" name="library_search_min_length"
                                               class="form-control" min="1" max="10" step="1" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Mindestanzahl Zeichen f√ºr Suche (1-10)</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Uploads & Downloads Tab -->
                    <div class="tab-pane" id="files-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üì• Downloads</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label for="downloadsPath">Download-Verzeichnis üìÇ</label>
                                        <input type="text" id="downloadsPath" name="downloads_path" class="form-control"
                                               placeholder="z.B. C:\Downloads\Printernizer" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Verzeichnis f√ºr heruntergeladene Dateien</small>
                                    </div>

                                    <div class="form-group">
                                        <div class="validation-result" id="downloadsPathValidationResult" style="display: none;"></div>
                                    </div>

                                    <div class="form-group">
                                        <button type="button" class="btn btn-secondary" onclick="validateDownloadsPath()">
                                            <span class="btn-icon">‚úì</span>
                                            Pfad validieren
                                        </button>
                                    </div>

                                    <div class="form-group">
                                        <label for="maxFileSize">Max. Download-Gr√∂√üe (MB) üì¶</label>
                                        <input type="number" id="maxFileSize" name="max_file_size"
                                               class="form-control" min="1" max="1000" step="1" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Maximale Gr√∂√üe f√ºr Datei-Downloads (1-1000 MB)</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üì§ Uploads</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableUpload" name="enable_upload" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Datei-Upload aktivieren ‚úÖ
                                        </label>
                                        <small class="form-text text-muted">
                                            Erlaubt das Hochladen von Dateien in die Bibliothek
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="maxUploadSizeMb">Max. Upload-Gr√∂√üe (MB) üì¶</label>
                                        <input type="number" id="maxUploadSizeMb" name="max_upload_size_mb"
                                               class="form-control" min="1" max="5000" step="1" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Maximale Gr√∂√üe f√ºr Datei-Uploads (1-5000 MB)</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="allowedUploadExtensions">Erlaubte Dateierweiterungen üìã</label>
                                        <input type="text" id="allowedUploadExtensions" name="allowed_upload_extensions"
                                               class="form-control" form="applicationSettingsForm"
                                               placeholder=".3mf,.stl,.gcode,.obj,.ply">
                                        <small class="form-text text-muted">Komma-getrennte Liste erlaubter Dateiformate</small>
                                    </div>

                                    <div class="alert alert-info">
                                        <strong>üí° Standard-Formate:</strong> .3mf, .stl, .gcode, .obj, .ply
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Timelapse Tab -->
                    <div class="tab-pane" id="timelapse-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üé¨ Timelapse-Verarbeitung</h3>
                            </div>
                            <div class="card-body">
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="timelapseEnabled" name="timelapse_enabled" form="applicationSettingsForm">
                                            <span class="checkbox-custom"></span>
                                            Timelapse-Funktion aktivieren ‚úÖ
                                        </label>
                                        <small class="form-text text-muted">
                                            Automatische Verarbeitung von Druckfotos zu Timelapse-Videos
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="timelapseSourceFolder">Quell-Verzeichnis üìÇ</label>
                                        <input type="text" id="timelapseSourceFolder" name="timelapse_source_folder"
                                               class="form-control" form="applicationSettingsForm"
                                               placeholder="z.B. ./data/timelapse/source">
                                        <small class="form-text text-muted">Ordner mit Timelapse-Bildern vom Drucker</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="timelapseOutputFolder">Ausgabe-Verzeichnis üéûÔ∏è</label>
                                        <input type="text" id="timelapseOutputFolder" name="timelapse_output_folder"
                                               class="form-control" form="applicationSettingsForm"
                                               placeholder="z.B. ./data/timelapse/output">
                                        <small class="form-text text-muted">Ordner f√ºr fertige Timelapse-Videos</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="timelapseOutputStrategy">Ausgabe-Strategie üìã</label>
                                        <select id="timelapseOutputStrategy" name="timelapse_output_strategy" class="form-control" form="applicationSettingsForm">
                                            <option value="same">Gleicher Ordner wie Quelle</option>
                                            <option value="separate">Separater Ausgabe-Ordner</option>
                                            <option value="both">Beide Orte</option>
                                        </select>
                                        <small class="form-text text-muted">Wo sollen fertige Videos gespeichert werden?</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="timelapseAutoProcessTimeout">Auto-Verarbeitungs-Timeout (Sekunden) ‚è±Ô∏è</label>
                                        <input type="number" id="timelapseAutoProcessTimeout" name="timelapse_auto_process_timeout"
                                               class="form-control" min="60" max="3600" step="30" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Zeit nach Druckende bis zur automatischen Verarbeitung (60-3600 Sek.)</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="timelapseCleanupAgeDays">Automatisches L√∂schen nach (Tage) üóëÔ∏è</label>
                                        <input type="number" id="timelapseCleanupAgeDays" name="timelapse_cleanup_age_days"
                                               class="form-control" min="1" max="365" step="1" form="applicationSettingsForm">
                                        <small class="form-text text-muted">Alte Timelapse-Dateien automatisch l√∂schen nach X Tagen (1-365)</small>
                                    </div>

                                    <div class="form-group">
                                        <label>FFmpeg-Verf√ºgbarkeit pr√ºfen üîß</label>
                                        <div class="ffmpeg-check-container">
                                            <button type="button" class="btn btn-secondary" onclick="checkFfmpegInstallation()">
                                                <span class="btn-icon">üîç</span>
                                                FFmpeg pr√ºfen
                                            </button>
                                            <div id="ffmpegCheckResult" class="validation-result" style="display: none; margin-top: 0.5rem;"></div>
                                        </div>
                                        <small class="form-text text-muted">
                                            Pr√ºfen Sie, ob FFmpeg auf dem System installiert ist. FFmpeg wird f√ºr die Timelapse-Videogenerierung ben√∂tigt.
                                        </small>
                                    </div>

                                    <div class="alert alert-info">
                                        <strong>‚ÑπÔ∏è Hinweis:</strong> Timelapse-Funktion erfordert ffmpeg oder vergleichbare Software.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Watch Folders Tab -->
                    <div class="tab-pane" id="watch-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üëÅÔ∏è √úberwachte Verzeichnisse</h3>
                            </div>
                            <div class="card-body">
                                <form id="watchFolderSettingsForm" class="settings-form">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="watchFoldersEnabled" name="enabled">
                                            <span class="checkbox-custom"></span>
                                            Verzeichnis√ºberwachung aktiviert ‚úÖ
                                        </label>
                                        <small class="form-text text-muted">
                                            Automatisches Erkennen neuer Dateien in √ºberwachten Ordnern
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="watchFoldersRecursive" name="recursive">
                                            <span class="checkbox-custom"></span>
                                            Rekursive √úberwachung (Unterverzeichnisse) üìÅ
                                        </label>
                                        <small class="form-text text-muted">
                                            Auch Unterordner √ºberwachen
                                        </small>
                                    </div>

                                    <div class="form-group">
                                        <label for="watchFolders">√úberwachte Verzeichnisse üìÇ</label>
                                        <div id="watchFoldersList" class="watch-folders-list">
                                            <!-- Dynamic content -->
                                        </div>
                                    </div>

                                    <div class="alert alert-info">
                                        <strong>üí° Tipp:</strong> √úberwachte Ordner werden automatisch nach neuen 3D-Druck-Dateien durchsucht.
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- System Tab -->
                    <div class="tab-pane" id="system-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üìä System-Informationen</h3>
                            </div>
                            <div class="card-body">
                                <div class="system-info" id="systemInfo">
                                    <div class="loading-placeholder">
                                        <div class="spinner"></div>
                                        <p>Lade System-Informationen...</p>
                                    </div>
                                </div>
                                <div class="system-actions" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                                    <button class="btn btn-danger" onclick="shutdownServer()">
                                        <span class="btn-icon">‚èπÔ∏è</span>
                                        Server herunterfahren
                                    </button>
                                    <p class="text-muted" style="margin-top: 10px; font-size: 0.875rem;">
                                        ‚ö†Ô∏è Der Server wird ordnungsgem√§√ü heruntergefahren. Alle Dienste werden gestoppt.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üßô Setup-Assistent</h3>
                            </div>
                            <div class="card-body">
                                <p class="text-muted" style="margin-bottom: 15px;">
                                    F√ºhre den Setup-Assistenten erneut aus, um deine Grundeinstellungen anzupassen.
                                </p>
                                <button id="rerunSetupWizard" class="btn btn-secondary">
                                    <span class="btn-icon">üîÑ</span>
                                    Setup-Assistent erneut starten
                                </button>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üß≠ Navigationsleiste</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <p class="text-muted">
                                        Passen Sie die Reihenfolge und Sichtbarkeit der Navigationselemente an.
                                    </p>
                                </div>

                                <div id="navigationSectionsList" class="navigation-sections-list">
                                    <!-- Dynamic content will be inserted here -->
                                </div>

                                <div class="navigation-actions" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                                    <button class="btn btn-secondary" onclick="navigationPreferencesManager.resetNavigationPreferences()">
                                        <span class="btn-icon">üîÑ</span>
                                        Auf Standardeinstellungen zur√ºcksetzen
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üì± iOS App verbinden</h3>
                            </div>
                            <div class="card-body">
                                <div class="ios-app-section">
                                    <p>
                                        Scanne diesen QR-Code mit der <strong>Printernizer iOS App</strong>, um die App automatisch mit diesem Server zu verbinden.
                                    </p>
                                    <div class="qr-code-container" style="text-align: center; margin: 20px 0;">
                                        <div id="serverQRCode" style="display: inline-block; padding: 16px; background: white; border-radius: 8px;"></div>
                                        <p id="serverURLDisplay" class="text-muted" style="margin-top: 12px; font-family: monospace;"></p>
                                    </div>
                                    <p class="text-muted" style="font-size: 0.9em;">
                                        Die iOS App ist kostenlos im App Store erh√§ltlich. Nach dem Scannen wird die Server-URL automatisch in der App eingetragen.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>‚òï Entwicklung unterst√ºtzen</h3>
                            </div>
                            <div class="card-body">
                                <div class="support-section">
                                    <p>
                                        <strong>Printernizer</strong> ist ein Open-Source-Projekt, das mit Leidenschaft entwickelt wird.
                                        Wenn dir diese Software hilft, deine 3D-Drucker zu verwalten, w√ºrde ich mich √ºber deine Unterst√ºtzung freuen!
                                    </p>
                                    <div class="support-actions">
                                        <a href="https://buymeacoffee.com/porcus3d" target="_blank" class="btn btn-support btn-lg">
                                            ‚òï Einen Kaffee spendieren
                                        </a>
                                        <div class="support-info">
                                            <p class="text-muted">
                                                Deine Unterst√ºtzung hilft dabei, neue Features zu entwickeln und die Software zu verbessern.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Privacy & Usage Statistics Tab -->
                    <div class="tab-pane" id="privacy-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üîí Datenschutz & Nutzungsstatistiken</h3>
                            </div>
                            <div class="card-body">
                                <div class="privacy-intro">
                                    <p>
                                        Helfen Sie uns, Printernizer zu verbessern, indem Sie anonyme Nutzungsstatistiken teilen.
                                        Ihre Privatsph√§re hat h√∂chste Priorit√§t ‚Äì alle Daten sind <strong>vollst√§ndig anonym</strong>
                                        und enthalten keine pers√∂nlichen Informationen.
                                    </p>
                                </div>

                                <div class="form-group" style="margin-top: 20px;">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="usageStatsOptIn" onchange="usageStatistics.toggleOptIn()">
                                        <span class="checkbox-custom"></span>
                                        Anonyme Nutzungsstatistiken teilen üìä
                                    </label>
                                    <small class="form-text text-muted">
                                        Durch die Aktivierung helfen Sie uns, Fehler zu identifizieren und h√§ufig genutzte Features zu priorisieren
                                    </small>
                                </div>

                                <div id="usageStatsOptInMessage" class="alert" style="margin-top: 15px; display: none;">
                                    <!-- Dynamic status messages -->
                                </div>

                                <div class="privacy-info" style="margin-top: 30px;">
                                    <h4 style="font-size: 1.1rem; margin-bottom: 15px;">‚úÖ Was wir sammeln:</h4>
                                    <ul class="privacy-list">
                                        <li>App-Version und Deployment-Modus (Docker, Home Assistant, etc.)</li>
                                        <li>Anzahl und Typen der Drucker (z.B. "2x Bambu Lab, 1x Prusa")</li>
                                        <li>Feature-Nutzung (welche Features aktiviert sind)</li>
                                        <li>Anonyme Fehlertypen (ohne Details oder Pfade)</li>
                                        <li>Aggregierte Nutzungszahlen (Jobs pro Woche, etc.)</li>
                                    </ul>

                                    <h4 style="font-size: 1.1rem; margin-top: 20px; margin-bottom: 15px;">‚ùå Was wir NICHT sammeln:</h4>
                                    <ul class="privacy-list">
                                        <li><strong>Keine</strong> pers√∂nlichen Informationen (Name, E-Mail, etc.)</li>
                                        <li><strong>Keine</strong> Dateinamen oder Druckauftrag-Details</li>
                                        <li><strong>Keine</strong> IP-Adressen oder Standortdaten</li>
                                        <li><strong>Keine</strong> Drucker-Seriennummern oder Netzwerk-Informationen</li>
                                        <li><strong>Keine</strong> Verhaltens-Tracking (Klicks, Seitenaufrufe, etc.)</li>
                                    </ul>

                                    <div class="alert alert-info" style="margin-top: 20px;">
                                        <strong>üîí Datenschutz-Garantie:</strong>
                                        Alle Statistiken werden nur <strong>lokal gespeichert</strong>.
                                        Nur wenn Sie aktiv zustimmen, werden aggregierte Daten w√∂chentlich √ºbermittelt.
                                        Sie k√∂nnen jederzeit alle lokalen Daten l√∂schen.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Local Statistics Viewer -->
                        <div class="card settings-section" id="usageStatsLocalCard">
                            <div class="card-header">
                                <h3>üìä Ihre lokalen Statistiken</h3>
                                <button class="btn btn-sm btn-secondary" onclick="usageStatistics.refreshLocalStats()">
                                    <span class="btn-icon">üîÑ</span>
                                    Aktualisieren
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="usageStatsLocalData">
                                    <div class="loading-placeholder">
                                        <div class="spinner"></div>
                                        <p>Lade Statistiken...</p>
                                    </div>
                                </div>

                                <div class="stats-actions" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                                    <button class="btn btn-secondary" onclick="usageStatistics.exportData()">
                                        <span class="btn-icon">üì§</span>
                                        Daten exportieren
                                    </button>
                                    <button class="btn btn-danger" onclick="usageStatistics.deleteAllData()">
                                        <span class="btn-icon">üóëÔ∏è</span>
                                        Alle Daten l√∂schen
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Global Installation Statistics Dashboard (Admin) -->
                        <div class="card settings-section" id="globalStatsCard">
                            <div class="card-header">
                                <h3>üìà Global Installation Statistics</h3>
                                <button class="btn btn-sm btn-secondary" onclick="adminStats.refresh()">
                                    <span class="btn-icon">üîÑ</span>
                                    Refresh
                                </button>
                            </div>
                            <div class="card-body">
                                <p class="text-muted" style="margin-bottom: 20px;">
                                    View aggregated statistics from all Printernizer installations.
                                    Requires access to the aggregation service.
                                </p>

                                <!-- Connection Config -->
                                <div id="aggregationServiceConfig">
                                    <div class="aggregation-config">
                                        <div class="form-group">
                                            <label for="aggregationUrl">Aggregation Service URL</label>
                                            <input type="url" id="aggregationUrl" class="form-control"
                                                   placeholder="https://stats.printernizer.io">
                                            <small class="form-text text-muted">URL of the aggregation service</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="aggregationApiKey">API Key</label>
                                            <input type="password" id="aggregationApiKey" class="form-control"
                                                   placeholder="Enter API key">
                                        </div>
                                        <button class="btn btn-primary" onclick="adminStats.connect()">
                                            <span class="btn-icon">üîó</span>
                                            Connect
                                        </button>
                                    </div>
                                </div>

                                <!-- Dashboard (hidden until connected) -->
                                <div id="globalStatsDashboard" style="display: none;">
                                    <!-- Overview Cards -->
                                    <div class="stats-overview-grid">
                                        <div class="stats-card">
                                            <div class="stats-number" id="totalInstallations">-</div>
                                            <div class="stats-label">Total Installations</div>
                                        </div>
                                        <div class="stats-card">
                                            <div class="stats-number" id="active7d">-</div>
                                            <div class="stats-label">Active (7 days)</div>
                                        </div>
                                        <div class="stats-card">
                                            <div class="stats-number" id="active30d">-</div>
                                            <div class="stats-label">Active (30 days)</div>
                                        </div>
                                        <div class="stats-card">
                                            <div class="stats-number" id="growth7d">-</div>
                                            <div class="stats-label">Growth (7 days)</div>
                                        </div>
                                    </div>

                                    <!-- Anomaly Alerts -->
                                    <div class="anomaly-alerts-section" id="anomalyAlerts">
                                        <div class="anomaly-status anomaly-ok">
                                            <span class="anomaly-icon">&#x2705;</span>
                                            <span>No anomalies detected</span>
                                        </div>
                                    </div>

                                    <!-- Charts Grid -->
                                    <div class="stats-charts-grid">
                                        <div class="chart-container">
                                            <h4>Installations Over Time</h4>
                                            <canvas id="installationsChart"></canvas>
                                        </div>
                                        <div class="chart-container">
                                            <h4>Deployment Mode Distribution</h4>
                                            <canvas id="deploymentChart"></canvas>
                                        </div>
                                        <div class="chart-container">
                                            <h4>Version Adoption</h4>
                                            <canvas id="versionsChart"></canvas>
                                        </div>
                                        <div class="chart-container">
                                            <h4>Geographic Distribution</h4>
                                            <canvas id="geographyChart"></canvas>
                                        </div>
                                        <div class="chart-container">
                                            <h4>Feature Usage</h4>
                                            <canvas id="featuresChart"></canvas>
                                        </div>
                                    </div>

                                    <!-- Timestamp and Actions -->
                                    <div class="stats-timestamp" id="statsLastUpdated"></div>
                                    <div class="stats-actions">
                                        <button class="btn btn-secondary" onclick="adminStats.exportData()">
                                            <span class="btn-icon">üì§</span>
                                            Export JSON
                                        </button>
                                        <button class="btn btn-secondary" onclick="adminStats.disconnect()">
                                            <span class="btn-icon">üîå</span>
                                            Disconnect
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Privacy Policy Link -->
                        <div class="card settings-section">
                            <div class="card-body">
                                <p class="text-muted" style="margin: 0;">
                                    Weitere Informationen finden Sie in unserer
                                    <a href="https://github.com/schmacka/printernizer/blob/master/docs/development/usage-statistics-privacy.md"
                                       target="_blank" rel="noopener">Datenschutzerkl√§rung</a>.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Tab -->
                    <div class="tab-pane" id="notifications-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üîî Notification Channels</h3>
                                <button class="btn btn-primary" onclick="notificationManager.showAddChannel()">
                                    <span class="btn-icon">‚ûï</span>
                                    Add Channel
                                </button>
                            </div>
                            <div class="card-body">
                                <p class="text-muted" style="margin-bottom: 20px;">
                                    Configure notification channels to receive alerts when print jobs complete, printers go offline, and more.
                                    Supports Discord, Slack, and ntfy.sh.
                                </p>
                                <div id="notificationChannelsList">
                                    <div class="loading-placeholder">
                                        <div class="spinner"></div>
                                        <p>Loading notification channels...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Appearance Tab -->
                    <div class="tab-pane" id="appearance-tab">
                        <div class="card settings-section">
                            <div class="card-header">
                                <h3>üé® Theme Selection</h3>
                            </div>
                            <div class="card-body">
                                <p class="text-muted" style="margin-bottom: 20px;">
                                    Choose a visual theme for Printernizer. Click on a theme to apply it instantly.
                                </p>
                                <div class="theme-picker-grid" id="themePicker">
                                    <!-- Theme cards will be rendered by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        </div>

        <!-- Notification Channel Modal -->
        <div id="notificationChannelModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="channelModalTitle">Add Notification Channel</h2>
                    <button class="modal-close" onclick="notificationManager.hideModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="channelForm" onsubmit="event.preventDefault(); notificationManager.saveChannel();">
                        <div class="form-group">
                            <label for="channelName">Channel Name</label>
                            <input type="text" id="channelName" class="form-control" placeholder="e.g., Discord Alerts" required>
                        </div>

                        <div class="form-group">
                            <label for="channelType">Channel Type</label>
                            <select id="channelType" class="form-control" required>
                                <option value="discord">Discord</option>
                                <option value="slack">Slack</option>
                                <option value="ntfy">ntfy.sh</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="channelWebhookUrl" id="webhookUrlLabel">Webhook URL</label>
                            <input type="url" id="channelWebhookUrl" class="form-control" placeholder="https://..." required>
                            <small class="form-text text-muted" id="webhookUrlHelp">Discord webhook URL from channel settings</small>
                        </div>

                        <div class="form-group" id="topicGroup" style="display: none;">
                            <label for="channelTopic">Topic</label>
                            <input type="text" id="channelTopic" class="form-control" placeholder="e.g., printernizer-alerts">
                            <small class="form-text text-muted">ntfy topic name for receiving notifications</small>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="channelEnabled" checked>
                                <span class="checkbox-custom"></span>
                                Channel Enabled
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Event Subscriptions</label>
                            <div class="event-subscription-actions">
                                <button type="button" class="btn btn-sm btn-secondary" onclick="notificationManager.toggleAllEvents(true)">Select All</button>
                                <button type="button" class="btn btn-sm btn-secondary" onclick="notificationManager.toggleAllEvents(false)">Deselect All</button>
                            </div>
                            <div id="eventCheckboxes" class="event-checkboxes">
                                <!-- Event checkboxes rendered dynamically -->
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="notificationManager.hideModal()">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="notificationManager.saveChannel()">Save Channel</button>
                </div>
            </div>
        </div>

        <!-- Debug Page -->
        <div id="debug" class="page">
            <div class="page-header">
                <h1>Debug & Systemprotokoll</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshDebugInfo()">
                        <span class="btn-icon">üîÑ</span>
                        Aktualisieren
                    </button>
                    <button class="btn btn-secondary" onclick="clearLogs()">
                        <span class="btn-icon">üóëÔ∏è</span>
                        Logs l√∂schen
                    </button>
                    <button class="btn btn-primary" onclick="downloadLogs()">
                        <span class="btn-icon">üíæ</span>
                        Logs herunterladen
                    </button>
                </div>
            </div>

            <div class="debug-container">
                <!-- System Health -->
                <div class="card debug-section">
                    <div class="card-header">
                        <h3>System-Status</h3>
                        <span class="card-icon">‚ù§Ô∏è</span>
                    </div>
                    <div class="card-body">
                        <div class="health-info" id="healthInfo">
                            <div class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade System-Status...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Application Logs -->
                <div class="card debug-section">
                    <div class="card-header">
                        <h3>Anwendungsprotokolle</h3>
                        <span class="card-icon">üìù</span>
                        <div class="log-controls">
                            <select id="logLevelFilter" class="filter-select">
                                <option value="">Alle Level</option>
                                <option value="ERROR">Nur Fehler</option>
                                <option value="WARNING">Warnungen +</option>
                                <option value="INFO">Info +</option>
                                <option value="DEBUG">Debug</option>
                            </select>
                            <label class="checkbox-label">
                                <input type="checkbox" id="autoRefreshLogs" checked>
                                <span class="checkbox-custom"></span>
                                Auto-Aktualisierung
                            </label>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="log-viewer" id="logViewer">
                            <div class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade Protokolle...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="card debug-section">
                    <div class="card-header">
                        <h3>Performance-Metriken</h3>
                        <span class="card-icon">üìà</span>
                    </div>
                    <div class="card-body">
                        <div class="metrics-grid" id="performanceMetrics">
                            <div class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade Metriken...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thumbnail Processing Log -->
                <div class="card debug-section">
                    <div class="card-header">
                        <h3>Thumbnail Processing Log</h3>
                        <span class="card-icon">üñºÔ∏è</span>
                    </div>
                    <div class="card-body">
                        <div class="debug-controls">
                            <button onclick="debugManager.refreshThumbnailLog()" class="btn btn-sm">
                                üîÑ Aktualisieren
                            </button>
                            <select id="thumbnailLogLimit" onchange="debugManager.refreshThumbnailLog()">
                                <option value="10">10 Eintr√§ge</option>
                                <option value="20" selected>20 Eintr√§ge</option>
                                <option value="50">50 Eintr√§ge</option>
                            </select>
                        </div>
                        <div id="thumbnailProcessingLog">
                            <div class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade Thumbnail-Verarbeitung...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API Endpoints Test -->
                <div class="card debug-section">
                    <div class="card-header">
                        <h3>API-Endpoints Test</h3>
                        <span class="card-icon">üîå</span>
                    </div>
                    <div class="card-body">
                        <div class="api-test-grid" id="apiTests">
                            <div class="loading-placeholder">
                                <div class="spinner"></div>
                                <p>Lade API-Tests...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Add Printer Modal -->
    <div id="addPrinterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Drucker hinzuf√ºgen</h3>
                <button class="modal-close" onclick="closeModal('addPrinterModal')">&times;</button>
            </div>
            <form id="addPrinterForm" class="modal-body">
                <div class="form-group">
                    <label for="printerType">Drucker Typ</label>
                    <select id="printerType" name="printerType" class="form-control" required>
                        <option value="">Typ ausw√§hlen</option>
                        <option value="bambu_lab">Bambu Lab A1</option>
                        <option value="prusa_core">Prusa Core One</option>
                    </select>
                </div>
                
                <div class="form-group" id="ipaKeyGroup" style="display: none;">
                    <label for="ipaKey">PrusaLink API Key</label>
                    <input type="text" id="ipaKey" name="ipaKey" class="form-control"
                           data-validate="api-key"
                           placeholder="PrusaLink API Key" 
                           minlength="8" maxlength="128">
                    <small class="form-text text-muted">API Key von PrusaLink (Drucker Web-Interface ‚Üí Settings ‚Üí API)</small>
                </div>
                
                <div class="form-group">
                    <label for="printerName">Name</label>
                    <input type="text" id="printerName" name="printerName" class="form-control" required 
                           data-validate="printer-name"
                           placeholder="Mein Drucker" 
                           minlength="3" maxlength="50">
                    <small class="form-text text-muted">3-50 Zeichen (Buchstaben, Zahlen, Leerzeichen)</small>
                </div>
                
                <div class="form-group">
                    <label for="printerIP">IP-Adresse</label>
                    <input type="text" id="printerIP" name="printerIP" class="form-control" required 
                           data-validate="ip"
                           placeholder="192.168.1.100" 
                           pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}">
                    <small class="form-text text-muted">Format: xxx.xxx.xxx.xxx</small>
                </div>
                
                <div id="bambuFields" class="printer-specific-fields" style="display: none;">
                    <div class="form-group">
                        <label for="accessCode">Access Code</label>
                        <input type="text" id="accessCode" name="accessCode" class="form-control"
                               data-validate="access-code"
                               placeholder="12345678" 
                               pattern="\d{8}" 
                               maxlength="8">
                        <small class="form-text text-muted">Genau 8 Ziffern (vom Drucker-Display)</small>
                    </div>
                    <div class="form-group">
                        <label for="serialNumber">Seriennummer</label>
                        <input type="text" id="serialNumber" name="serialNumber" class="form-control"
                               data-validate="serial-number"
                               placeholder="03919C431601127" 
                               pattern="[A-Z0-9]{8,20}" 
                               maxlength="20">
                        <small class="form-text text-muted">8-20 Zeichen (vom Drucker-Geh√§use oder Einstellungen)</small>
                    </div>
                </div>
                
                <div id="prusaFields" class="printer-specific-fields" style="display: none;">
                    <!-- Prusa-specific fields would go here if needed -->
                </div>

                <div class="form-group">
                    <label for="printerWebcamUrl">External Webcam URL (Optional)</label>
                    <input type="text" id="printerWebcamUrl" name="printerWebcamUrl" class="form-control"
                           data-validate="webcam-url"
                           placeholder="http://user:pass@camera-ip/snap.jpg or rtsp://camera-ip/stream"
                           maxlength="500">
                    <small class="form-text text-muted">HTTP snapshot URL or RTSP stream. Credentials can be embedded in URL.</small>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="printerActive" name="printerActive" checked>
                        <span class="checkbox-custom"></span>
                        Drucker aktivieren
                    </label>
                    <small class="form-text text-muted">Aktivierte Drucker werden √ºberwacht und k√∂nnen Auftr√§ge empfangen</small>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addPrinterModal')">
                    Abbrechen
                </button>
                <button type="submit" form="addPrinterForm" class="btn btn-primary">
                    <span class="btn-icon">‚ûï</span>
                    Hinzuf√ºgen
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Printer Modal -->
    <div id="editPrinterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Drucker bearbeiten</h3>
                <button class="modal-close" onclick="closeModal('editPrinterModal')">&times;</button>
            </div>
            <form id="editPrinterForm" class="modal-body">
                <input type="hidden" id="editPrinterId" name="printerId">
                
                <div class="form-group">
                    <label for="editPrinterType">Drucker Typ</label>
                    <select id="editPrinterType" name="printerType" class="form-control" required>
                        <option value="">Typ ausw√§hlen</option>
                        <option value="bambu_lab">Bambu Lab A1</option>
                        <option value="prusa_core">Prusa Core One</option>
                    </select>
                </div>
                
                <div class="form-group" id="editIpaKeyGroup" style="display: none;">
                    <label for="editIpaKey">PrusaLink API Key</label>
                    <input type="text" id="editIpaKey" name="ipaKey" class="form-control"
                           data-validate="api-key"
                           placeholder="PrusaLink API Key" 
                           minlength="8" maxlength="128">
                    <small class="form-text text-muted">API Key von PrusaLink (Drucker Web-Interface ‚Üí Settings ‚Üí API)</small>
                </div>
                
                <div class="form-group">
                    <label for="editPrinterName">Name</label>
                    <input type="text" id="editPrinterName" name="printerName" class="form-control" required 
                           data-validate="printer-name"
                           placeholder="Mein Drucker" 
                           minlength="3" maxlength="50">
                    <small class="form-text text-muted">3-50 Zeichen (Buchstaben, Zahlen, Leerzeichen)</small>
                </div>
                
                <div class="form-group">
                    <label for="editPrinterIP">IP-Adresse</label>
                    <input type="text" id="editPrinterIP" name="printerIP" class="form-control" required 
                           data-validate="ip"
                           placeholder="192.168.1.100" 
                           pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}">
                    <small class="form-text text-muted">Format: xxx.xxx.xxx.xxx</small>
                </div>
                
                <div id="editBambuFields" class="printer-specific-fields" style="display: none;">
                    <div class="form-group">
                        <label for="editAccessCode">Access Code</label>
                        <input type="text" id="editAccessCode" name="accessCode" class="form-control"
                               data-validate="access-code"
                               placeholder="12345678" 
                               pattern="\d{8}" 
                               maxlength="8">
                        <small class="form-text text-muted">Genau 8 Ziffern (vom Drucker-Display)</small>
                    </div>
                    <div class="form-group">
                        <label for="editSerialNumber">Seriennummer</label>
                        <input type="text" id="editSerialNumber" name="serialNumber" class="form-control"
                               data-validate="serial-number"
                               placeholder="03919C431601127" 
                               pattern="[A-Z0-9]{8,20}" 
                               maxlength="20">
                        <small class="form-text text-muted">8-20 Zeichen (vom Drucker-Geh√§use oder Einstellungen)</small>
                    </div>
                </div>
                
                <div id="editPrusaFields" class="printer-specific-fields" style="display: none;">
                    <!-- Prusa-specific fields would go here if needed -->
                </div>

                <div class="form-group">
                    <label for="editPrinterWebcamUrl">External Webcam URL (Optional)</label>
                    <input type="text" id="editPrinterWebcamUrl" name="printerWebcamUrl" class="form-control"
                           data-validate="webcam-url"
                           placeholder="http://user:pass@camera-ip/snap.jpg or rtsp://camera-ip/stream"
                           maxlength="500">
                    <small class="form-text text-muted">HTTP snapshot URL or RTSP stream. Credentials can be embedded in URL.</small>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="editPrinterActive" name="printerActive" checked>
                        <span class="checkbox-custom"></span>
                        Drucker aktivieren
                    </label>
                    <small class="form-text text-muted">Aktivierte Drucker werden √ºberwacht und k√∂nnen Auftr√§ge empfangen</small>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('editPrinterModal')">
                    Abbrechen
                </button>
                <button type="submit" form="editPrinterForm" class="btn btn-primary">
                    <span class="btn-icon">üíæ</span>
                    Speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Job Details Modal -->
    <div id="jobDetailsModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Auftrag Details</h3>
                <button class="modal-close" onclick="closeModal('jobDetailsModal')">&times;</button>
            </div>
            <div class="modal-body" id="jobDetailsContent">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>Lade Details...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div id="filePreviewModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Datei Vorschau</h3>
                <button class="modal-close" onclick="closeModal('filePreviewModal')">&times;</button>
            </div>
            <div class="modal-body" id="filePreviewContent">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>Lade Vorschau...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Watch Folder Modal -->
    <div id="addWatchFolderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>√úberwachtes Verzeichnis hinzuf√ºgen</h3>
                <button class="modal-close" onclick="closeModal('addWatchFolderModal')">&times;</button>
            </div>
            <form id="addWatchFolderForm" class="modal-body">
                <div class="form-group">
                    <label for="watchFolderPath">Verzeichnispfad</label>
                    <input type="text" id="watchFolderPath" name="folderPath" class="form-control" required 
                           placeholder="C:\Benutzer\Ihr Name\3D-Modelle"
                           data-validate="folder-path">
                    <small class="form-text text-muted">
                        Absoluter Pfad zum Verzeichnis, das √ºberwacht werden soll.<br>
                        Unterst√ºtzte Dateitypen: .stl, .3mf, .gcode, .obj, .ply
                    </small>
                </div>
                
                <div class="form-group">
                    <div class="validation-result" id="folderValidationResult" style="display: none;"></div>
                </div>
                
                <div class="form-group">
                    <button type="button" class="btn btn-secondary" onclick="validateWatchFolderPath()">
                        <span class="btn-icon">‚úì</span>
                        Pfad validieren
                    </button>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addWatchFolderModal')">
                    Abbrechen
                </button>
                <button type="submit" form="addWatchFolderForm" class="btn btn-primary" id="addWatchFolderSubmit">
                    <span class="btn-icon">üìÇ</span>
                    Hinzuf√ºgen
                </button>
            </div>
        </div>
    </div>

    <!-- Add Idea Modal -->
    <div id="addIdeaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Neue Idee hinzuf√ºgen</h3>
                <button class="modal-close" onclick="closeModal('addIdeaModal')">&times;</button>
            </div>
            <form id="addIdeaForm" class="modal-body">
                <div class="form-group">
                    <label for="ideaTitle">Titel <span class="required">*</span></label>
                    <input type="text" id="ideaTitle" name="title" class="form-control" required
                           placeholder="Meine neue Druckidee"
                           minlength="1" maxlength="255">
                </div>

                <div class="form-group">
                    <label for="ideaDescription">Beschreibung</label>
                    <textarea id="ideaDescription" name="description" class="form-control"
                              placeholder="Detaillierte Beschreibung der Idee..."
                              maxlength="2000" rows="4"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ideaCategory">Kategorie</label>
                        <input type="text" id="ideaCategory" name="category" class="form-control"
                               placeholder="z.B. Geschenk, Prototyp, Dekoration"
                               maxlength="100">
                    </div>

                    <div class="form-group">
                        <label for="ideaPriority">Priorit√§t</label>
                        <select id="ideaPriority" name="priority" class="form-control">
                            <option value="1">1 - Niedrig</option>
                            <option value="2">2 - Gering</option>
                            <option value="3" selected>3 - Mittel</option>
                            <option value="4">4 - Hoch</option>
                            <option value="5">5 - Sehr hoch</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ideaEstimatedTime">Gesch√§tzte Druckzeit (Minuten)</label>
                        <input type="number" id="ideaEstimatedTime" name="estimated_print_time"
                               class="form-control" min="0" placeholder="120">
                    </div>

                    <div class="form-group">
                        <label for="ideaPlannedDate">Geplantes Datum</label>
                        <input type="date" id="ideaPlannedDate" name="planned_date" class="form-control">
                    </div>
                </div>

                <div class="form-group">
                    <label for="ideaMaterialNotes">Material-Notizen</label>
                    <textarea id="ideaMaterialNotes" name="material_notes" class="form-control"
                              placeholder="PLA Rot, 0.2mm Schichth√∂he..."
                              maxlength="500" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label for="ideaTags">Tags (durch Komma getrennt)</label>
                    <input type="text" id="ideaTags" name="tags" class="form-control"
                           placeholder="geschenk, weihnachten, personalisiert">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="ideaIsBusiness" name="is_business">
                        <span class="checkbox-custom"></span>
                        Gesch√§ftlicher Auftrag
                    </label>
                </div>

                <div class="form-group" id="customerInfoGroup" style="display: none;">
                    <label for="ideaCustomerInfo">Kunden-Informationen</label>
                    <textarea id="ideaCustomerInfo" name="customer_info" class="form-control"
                              placeholder="Kundenname, Kontakt, spezielle Anforderungen..."
                              maxlength="500" rows="2"></textarea>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addIdeaModal')">
                    Abbrechen
                </button>
                <button type="submit" form="addIdeaForm" class="btn btn-primary">
                    <span class="btn-icon">üí°</span>
                    Idee speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Idea Modal -->
    <div id="editIdeaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Idee bearbeiten</h3>
                <button class="modal-close" onclick="closeModal('editIdeaModal')">&times;</button>
            </div>
            <form id="editIdeaForm" class="modal-body">
                <input type="hidden" id="editIdeaId" name="ideaId">

                <div class="form-group">
                    <label for="editIdeaTitle">Titel <span class="required">*</span></label>
                    <input type="text" id="editIdeaTitle" name="title" class="form-control" required
                           minlength="1" maxlength="255">
                </div>

                <div class="form-group">
                    <label for="editIdeaDescription">Beschreibung</label>
                    <textarea id="editIdeaDescription" name="description" class="form-control"
                              maxlength="2000" rows="4"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editIdeaCategory">Kategorie</label>
                        <input type="text" id="editIdeaCategory" name="category" class="form-control"
                               maxlength="100">
                    </div>

                    <div class="form-group">
                        <label for="editIdeaPriority">Priorit√§t</label>
                        <select id="editIdeaPriority" name="priority" class="form-control">
                            <option value="1">1 - Niedrig</option>
                            <option value="2">2 - Gering</option>
                            <option value="3">3 - Mittel</option>
                            <option value="4">4 - Hoch</option>
                            <option value="5">5 - Sehr hoch</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editIdeaStatus">Status</label>
                        <select id="editIdeaStatus" name="status" class="form-control">
                            <option value="idea">üí° Idee</option>
                            <option value="planned">üìÖ Geplant</option>
                            <option value="printing">üñ®Ô∏è Wird gedruckt</option>
                            <option value="completed">‚úÖ Abgeschlossen</option>
                            <option value="archived">üì¶ Archiviert</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editIdeaEstimatedTime">Gesch√§tzte Druckzeit (Minuten)</label>
                        <input type="number" id="editIdeaEstimatedTime" name="estimated_print_time"
                               class="form-control" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editIdeaPlannedDate">Geplantes Datum</label>
                        <input type="date" id="editIdeaPlannedDate" name="planned_date" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="editIdeaCompletedDate">Abgeschlossen am</label>
                        <input type="date" id="editIdeaCompletedDate" name="completed_date" class="form-control" readonly>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editIdeaMaterialNotes">Material-Notizen</label>
                    <textarea id="editIdeaMaterialNotes" name="material_notes" class="form-control"
                              maxlength="500" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label for="editIdeaTags">Tags (durch Komma getrennt)</label>
                    <input type="text" id="editIdeaTags" name="tags" class="form-control">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="editIdeaIsBusiness" name="is_business">
                        <span class="checkbox-custom"></span>
                        Gesch√§ftlicher Auftrag
                    </label>
                </div>

                <div class="form-group" id="editCustomerInfoGroup" style="display: none;">
                    <label for="editIdeaCustomerInfo">Kunden-Informationen</label>
                    <textarea id="editIdeaCustomerInfo" name="customer_info" class="form-control"
                              maxlength="500" rows="2"></textarea>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('editIdeaModal')">
                    Abbrechen
                </button>
                <button type="submit" form="editIdeaForm" class="btn btn-primary">
                    <span class="btn-icon">üíæ</span>
                    √Ñnderungen speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Import from URL Modal -->
    <div id="importIdeaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modell aus URL importieren</h3>
                <button class="modal-close" onclick="closeModal('importIdeaModal')">&times;</button>
            </div>
            <form id="importIdeaForm" class="modal-body">
                <div class="form-group">
                    <label for="importUrl">URL</label>
                    <input type="url" id="importUrl" name="url" class="form-control" required
                           placeholder="https://makerworld.com/models/123456 oder https://www.printables.com/model/123456">
                    <small class="form-text text-muted">
                        Unterst√ºtzte Plattformen: Makerworld, Printables, Thingiverse, MyMiniFactory, Cults3D
                    </small>
                </div>

                <div class="form-group">
                    <button type="button" class="btn btn-secondary" onclick="previewImportUrl()">
                        <span class="btn-icon">üëÅÔ∏è</span>
                        URL-Vorschau laden
                    </button>
                </div>

                <div id="urlPreview" class="url-preview" style="display: none;">
                    <div class="preview-content">
                        <div class="preview-thumbnail">
                            <img id="previewImage" src="" alt="Modell-Vorschau">
                        </div>
                        <div class="preview-info">
                            <h4 id="previewTitle">Modell-Titel</h4>
                            <p id="previewDescription">Beschreibung...</p>
                            <div class="preview-meta">
                                <span id="previewCreator">Ersteller: </span>
                                <span id="previewPlatform">Plattform: </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="importCategory">Kategorie</label>
                        <input type="text" id="importCategory" name="category" class="form-control"
                               placeholder="z.B. Dekoration, Werkzeug"
                               maxlength="100">
                    </div>

                    <div class="form-group">
                        <label for="importPriority">Priorit√§t</label>
                        <select id="importPriority" name="priority" class="form-control">
                            <option value="1">1 - Niedrig</option>
                            <option value="2">2 - Gering</option>
                            <option value="3" selected>3 - Mittel</option>
                            <option value="4">4 - Hoch</option>
                            <option value="5">5 - Sehr hoch</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="importTags">Tags (durch Komma getrennt)</label>
                    <input type="text" id="importTags" name="tags" class="form-control"
                           placeholder="makerworld, dekoration, miniatur">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="importIsBusiness" name="is_business">
                        <span class="checkbox-custom"></span>
                        Gesch√§ftlicher Auftrag
                    </label>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('importIdeaModal')">
                    Abbrechen
                </button>
                <button type="submit" form="importIdeaForm" class="btn btn-primary">
                    <span class="btn-icon">üîó</span>
                    Importieren
                </button>
            </div>
        </div>
    </div>

    <!-- Idea Details Modal -->
    <div id="ideaDetailsModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Idee Details</h3>
                <button class="modal-close" onclick="closeModal('ideaDetailsModal')">&times;</button>
            </div>
            <div class="modal-body" id="ideaDetailsContent">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>Lade Details...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Material Add/Edit Modal -->
    <div id="materialModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="materialModalTitle">Filament hinzuf√ºgen</h3>
                <button class="modal-close" onclick="materialsManager.closeModal()">&times;</button>
            </div>
            <form id="materialForm" class="modal-body">
                <input type="hidden" id="materialId" name="materialId">

                <div class="form-row">
                    <div class="form-group">
                        <label for="materialType">Typ <span class="required">*</span></label>
                        <select id="materialType" name="material_type" class="form-control" required>
                            <option value="">Typ ausw√§hlen</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="materialBrand">Marke <span class="required">*</span></label>
                        <input type="text" id="materialBrand" name="brand" class="form-control" required
                               placeholder="z.B. OVERTURE, Prusament"
                               maxlength="100">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="materialColor">Farbe <span class="required">*</span></label>
                        <input type="text" id="materialColor" name="color" class="form-control" required
                               placeholder="z.B. Rot, Blau, Transparent"
                               maxlength="50">
                    </div>

                    <div class="form-group">
                        <label for="materialColorHex">Farbcode (Hex)</label>
                        <input type="color" id="materialColorHex" name="color_hex" class="form-control">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="materialSpoolWeight">Spulengewicht (g) <span class="required">*</span></label>
                        <input type="number" id="materialSpoolWeight" name="spool_weight_g"
                               class="form-control" required min="0" step="1"
                               placeholder="1000">
                        <small class="form-text text-muted">Gewicht einer vollen Spule in Gramm</small>
                    </div>

                    <div class="form-group">
                        <label for="materialRemainingWeight">Restgewicht (g) <span class="required">*</span></label>
                        <input type="number" id="materialRemainingWeight" name="remaining_weight_g"
                               class="form-control" required min="0" step="1"
                               placeholder="800">
                        <small class="form-text text-muted">Aktuelles Restgewicht in Gramm</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="materialPricePerKg">Preis pro kg (‚Ç¨)</label>
                        <input type="number" id="materialPricePerKg" name="price_per_kg"
                               class="form-control" min="0" step="0.01"
                               placeholder="20.00">
                    </div>

                    <div class="form-group">
                        <label for="materialDiameter">Durchmesser (mm) <span class="required">*</span></label>
                        <select id="materialDiameter" name="diameter_mm" class="form-control" required>
                            <option value="1.75">1.75mm</option>
                            <option value="2.85">2.85mm</option>
                            <option value="3.00">3.00mm</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="materialLocation">Lagerort</label>
                    <input type="text" id="materialLocation" name="location" class="form-control"
                           placeholder="z.B. Regal A3, Schublade 2"
                           maxlength="100">
                </div>

                <div class="form-group">
                    <label for="materialNotes">Notizen</label>
                    <textarea id="materialNotes" name="notes" class="form-control"
                              placeholder="Zus√§tzliche Informationen..."
                              maxlength="500" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="materialIsActive" name="is_active" checked>
                        <span class="checkbox-custom"></span>
                        Aktiv
                    </label>
                    <small class="form-text text-muted">Nur aktive Filamente werden im Bestand angezeigt</small>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="materialsManager.closeModal()">
                    Abbrechen
                </button>
                <button type="submit" form="materialForm" class="btn btn-primary" id="materialSubmitBtn">
                    <span class="btn-icon">‚ûï</span>
                    Speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal settings-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <div class="settings-modal-title">
                    <h3>‚öôÔ∏è Einstellungen</h3>
                </div>
                <div class="modal-header-actions">
                    <select class="modal-tab-selector" onchange="switchModalSettingsTab(this.value)">
                        <!-- Options populated by JS -->
                    </select>
                    <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
                </div>
            </div>
            <div class="modal-body settings-modal-body">
                <!-- Settings content will be cloned here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeSettingsModal()">
                    Abbrechen
                </button>
                <button type="button" class="btn btn-primary" onclick="saveModalSettings()">
                    <span class="btn-icon">üíæ</span>
                    Speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Search Results Page -->
    <div id="search-results" class="page">
        <div class="page-header">
            <h1>üîç Search Results</h1>
        </div>
        <div id="search-results-container">
            <!-- Search results will be populated here by JavaScript -->
        </div>
    </div>

    <!-- Fullscreen 3D Preview Modal -->
    <div id="preview3dFullscreen" class="preview-3d-fullscreen">
        <button class="preview-3d-close" aria-label="Close preview">&times;</button>
        <div class="preview-3d-container">
            <div class="preview-3d-image-wrapper">
                <!-- Content injected by JavaScript -->
            </div>
            <div class="preview-3d-info">
                <!-- File info injected by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- QR Code library for iOS app setup -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <script src="js/error-handler.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/websocket.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/navigation-preferences.js"></script>
    <script src="js/components.js"></script>
    <script src="js/milestone-1-2-functions.js"></script>
    <script src="js/printer-form.js"></script>
    <script src="js/camera.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/printers.js"></script>
    <script src="js/jobs.js"></script>
    <script src="js/timelapses.js"></script>
    <script src="js/enhanced-metadata.js"></script>
    <script src="js/files.js"></script>
    <script src="js/ideas.js"></script>
    <script src="js/settings.js?v=1.1"></script>
    <script src="js/notifications.js?v=1.0"></script>
    <script src="js/usage-statistics.js"></script>
    <!-- Chart.js for statistics visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="js/admin-statistics.js"></script>
    <script src="js/navigation-preferences-ui.js"></script>
    <script src="js/debug.js?v=1.1"></script>

    <!-- Auto-Download System -->
    <script src="js/download-logger.js"></script>
    <script src="js/download-queue.js"></script>
    <script src="js/thumbnail-queue.js"></script>
    <script src="js/auto-download-manager.js"></script>
    <script src="js/auto-download-ui.js"></script>
    <script src="js/unified-log-viewer.js"></script>
    <script src="js/download-debug.js"></script>
    <script src="js/auto-download-init.js"></script>
    <script src="js/tags.js"></script>
    <script src="js/library.js"></script>
    <script src="js/materials.js"></script>
    <script src="js/search.js"></script>
    <script src="js/global-drag-drop.js"></script>
    <script src="js/setup-wizard.js"></script>
    <script src="js/preview-3d.js"></script>

    <script src="js/main.js?v=1.5"></script>

    <!-- Create Job Modal -->
    <div id="jobModal" class="modal job-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Job</h3>
                <button class="modal-close" onclick="closeJobModal()">&times;</button>
            </div>
            <form id="createJobForm" class="modal-body">
                <div class="form-group">
                    <label for="jobName">Job Name</label>
                    <input type="text" id="jobName" name="job_name" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="fileSelect">File</label>
                    <select id="fileSelect" name="file" class="form-control">
                        <option value="">Select a file...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="printerSelect">Printer</label>
                    <select id="printerSelect" name="printer" class="form-control">
                        <option value="">Select a printer...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="isBusiness" name="is_business">
                        <span class="checkbox-custom"></span>
                        Business Job
                    </label>
                </div>
                
                <div class="form-group" id="customerNameGroup" style="display: none;">
                    <label for="customerName">Customer Name</label>
                    <input type="text" id="customerName" name="customer_name" class="form-control">
                </div>
                
                <div id="costCalculationGroup" style="display: none;">
                    <div class="form-group">
                        <label for="materialCost">Material Cost (EUR)</label>
                        <input type="number" id="materialCost" name="material_cost" class="form-control" min="0" step="0.01" placeholder="0.00">
                    </div>
                    
                    <div class="vat-calculation-panel">
                        <h4>Cost Breakdown</h4>
                        <div class="vat-row">
                            <span>Net Price (excl. VAT):</span>
                            <span id="netPrice">‚Ç¨0.00</span>
                        </div>
                        <div class="vat-row">
                            <span>VAT (19%):</span>
                            <span id="vatAmount">‚Ç¨0.00</span>
                        </div>
                        <div class="vat-row vat-total">
                            <span><strong>Gross Total (incl. VAT):</strong></span>
                            <span id="grossTotal"><strong>‚Ç¨0.00</strong></span>
                        </div>
                    </div>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeJobModal()">
                    Cancel
                </button>
                <button type="submit" form="createJobForm" class="btn btn-primary submit-job-btn">
                    <span class="btn-icon">‚ûï</span>
                    Create Job
                </button>
            </div>
        </div>
    </div>

    <!-- Setup Wizard Overlay -->
    <div id="setupWizardOverlay" class="setup-wizard-overlay">
        <div class="setup-wizard-container">
            <!-- Wizard Header -->
            <div class="setup-wizard-header">
                <div class="setup-wizard-brand">
                    <img src="assets/logo.png" alt="Printernizer">
                    <span class="setup-wizard-brand-text">Setup Wizard</span>
                </div>
                <span id="wizardStepIndicator" class="setup-wizard-step-indicator">Schritt 1 von 5</span>
            </div>

            <!-- Progress Dots -->
            <div class="setup-wizard-progress">
                <div class="progress-dot active" data-step="1"></div>
                <div class="progress-dot" data-step="2"></div>
                <div class="progress-dot" data-step="3"></div>
                <div class="progress-dot" data-step="4"></div>
                <div class="progress-dot" data-step="5"></div>
            </div>

            <!-- Wizard Card -->
            <div class="setup-wizard-card">
                <div class="setup-wizard-content">
                    <!-- Step 1: Welcome -->
                    <div id="wizardStep1" class="wizard-step active">
                        <div class="welcome-icon">üëã</div>
                        <h2 class="wizard-step-title">Willkommen bei Printernizer!</h2>
                        <p class="wizard-step-subtitle">
                            Der Setup-Assistent hilft dir, dein 3D-Drucker-Management in wenigen Schritten einzurichten.
                        </p>
                        
                        <div class="welcome-features">
                            <h4>Was wir konfigurieren werden:</h4>
                            <ul>
                                <li>Deinen ersten 3D-Drucker verbinden</li>
                                <li>Speicherpfade f√ºr Downloads und Bibliothek festlegen</li>
                                <li>Optionale Features wie Zeitraffer aktivieren</li>
                            </ul>
                        </div>
                        
                        <p style="text-align: center; color: var(--gray-500); font-size: 0.9rem;">
                            Du kannst jeden Schritt √ºberspringen und sp√§ter manuell konfigurieren.
                        </p>
                    </div>

                    <!-- Step 2: Add Printer -->
                    <div id="wizardStep2" class="wizard-step">
                        <h2 class="wizard-step-title">Drucker hinzuf√ºgen</h2>
                        <p class="wizard-step-subtitle">
                            W√§hle deinen Druckertyp und gib die Verbindungsdaten ein.
                        </p>

                        <!-- Printer Type Selection -->
                        <div class="printer-type-selection">
                            <div class="printer-type-card" data-type="bambu_lab">
                                <div class="printer-icon">üñ®Ô∏è</div>
                                <div class="printer-type-name">Bambu Lab</div>
                                <div class="printer-type-desc">A1, A1 mini, X1, P1</div>
                            </div>
                            <div class="printer-type-card" data-type="prusa">
                                <div class="printer-icon">ü¶é</div>
                                <div class="printer-type-name">Prusa</div>
                                <div class="printer-type-desc">Core One</div>
                            </div>
                        </div>

                        <!-- Network Discovery -->
                        <div class="discovery-section">
                            <div class="discovery-header">
                                <h4>Automatische Erkennung</h4>
                                <button type="button" id="wizardDiscoverBtn" class="btn btn-secondary btn-sm">
                                    üîç Netzwerk durchsuchen
                                </button>
                            </div>
                            <div id="wizardDiscoveredList" class="discovered-printers-list">
                                <p style="text-align:center;color:var(--gray-500);padding:0.5rem;">
                                    Klicke auf "Netzwerk durchsuchen" um Drucker zu finden.
                                </p>
                            </div>
                        </div>

                        <!-- Printer Form -->
                        <div id="wizardPrinterForm" style="display: none;">
                            <div class="wizard-form-group">
                                <label for="wizardPrinterName">Drucker Name *</label>
                                <input type="text" id="wizardPrinterName" class="form-control" 
                                       placeholder="z.B. Mein Bambu A1">
                                <span class="form-hint">Ein freundlicher Name f√ºr deinen Drucker</span>
                            </div>

                            <div class="wizard-form-group">
                                <label for="wizardPrinterIp">IP-Adresse *</label>
                                <input type="text" id="wizardPrinterIp" class="form-control" 
                                       placeholder="z.B. 192.168.1.100">
                            </div>

                            <!-- Bambu Lab specific fields -->
                            <div id="wizardBambuFields" style="display: none;">
                                <div class="wizard-form-group">
                                    <label for="wizardBambuAccessCode">Zugangscode *</label>
                                    <input type="text" id="wizardBambuAccessCode" class="form-control" 
                                           placeholder="8-stelliger Code" maxlength="8">
                                    <span class="form-hint">Findest du in den Drucker-Einstellungen unter WLAN</span>
                                </div>
                                <div class="wizard-form-group">
                                    <label for="wizardBambuSerial">Seriennummer</label>
                                    <input type="text" id="wizardBambuSerial" class="form-control" 
                                           placeholder="Optional">
                                    <span class="form-hint">Optional, wird f√ºr einige Features ben√∂tigt</span>
                                </div>
                            </div>

                            <!-- Prusa specific fields -->
                            <div id="wizardPrusaFields" style="display: none;">
                                <div class="wizard-form-group">
                                    <label for="wizardPrusaApiKey">API-Key *</label>
                                    <input type="text" id="wizardPrusaApiKey" class="form-control" 
                                           placeholder="API-Key aus Drucker-Einstellungen">
                                    <span class="form-hint">Findest du in den Drucker-Einstellungen</span>
                                </div>
                            </div>

                            <div style="margin-top: 1rem;">
                                <button type="button" id="wizardTestConnection" class="btn btn-secondary">
                                    üîå Verbindung testen
                                </button>
                            </div>
                            <div id="wizardConnectionResult" class="connection-test-result" style="display: none;"></div>
                        </div>
                    </div>

                    <!-- Step 3: Configure Paths -->
                    <div id="wizardStep3" class="wizard-step">
                        <h2 class="wizard-step-title">Speicherpfade</h2>
                        <p class="wizard-step-subtitle">
                            Lege fest, wo deine Dateien gespeichert werden sollen.
                            <span id="wizardEnvInfo" style="font-size: 0.85em; color: var(--gray-500);"></span>
                        </p>

                        <div class="path-config-group">
                            <h4>üì• Downloads-Ordner</h4>
                            <p class="path-description">Hier werden heruntergeladene G-Code Dateien gespeichert.</p>
                            <div class="wizard-form-group">
                                <input type="text" id="wizardDownloadsPath" class="form-control" 
                                       placeholder="Pfad eingeben...">
                                <div id="wizardDownloadsValidation" class="path-validation"></div>
                            </div>
                        </div>

                        <div class="path-config-group">
                            <h4>üìö Bibliothek-Ordner</h4>
                            <p class="path-description">Zentrale Ablage f√ºr deine 3D-Modelle mit automatischer Organisation.</p>
                            <div class="wizard-form-group">
                                <input type="text" id="wizardLibraryPath" class="form-control" 
                                       placeholder="Pfad eingeben...">
                                <div id="wizardLibraryValidation" class="path-validation"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Optional Features -->
                    <div id="wizardStep4" class="wizard-step">
                        <h2 class="wizard-step-title">Optionale Features</h2>
                        <p class="wizard-step-subtitle">
                            Aktiviere zus√§tzliche Funktionen nach Bedarf.
                        </p>

                        <div class="feature-toggle-list">
                            <!-- Timelapse Feature -->
                            <div class="feature-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="wizardTimelapseToggle">
                                    <span class="toggle-slider"></span>
                                </label>
                                <div class="feature-toggle-content">
                                    <div class="feature-toggle-header">
                                        <span class="feature-toggle-title">üé¨ Zeitraffer</span>
                                    </div>
                                    <p class="feature-toggle-desc">
                                        Automatisch Zeitraffer-Videos aus Druckfotos erstellen.
                                    </p>
                                    <div id="wizardTimelapseConfig" class="feature-toggle-config" style="display: none;">
                                        <div class="wizard-form-group">
                                            <label for="wizardTimelapseSource">Quell-Ordner</label>
                                            <input type="text" id="wizardTimelapseSource" class="form-control" 
                                                   placeholder="Ordner mit Druckfotos">
                                        </div>
                                        <div class="wizard-form-group">
                                            <label for="wizardTimelapseOutput">Ausgabe-Ordner</label>
                                            <input type="text" id="wizardTimelapseOutput" class="form-control" 
                                                   placeholder="Ordner f√ºr fertige Videos">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Watch Folders Feature -->
                            <div class="feature-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="wizardWatchFoldersToggle">
                                    <span class="toggle-slider"></span>
                                </label>
                                <div class="feature-toggle-content">
                                    <div class="feature-toggle-header">
                                        <span class="feature-toggle-title">üëÅÔ∏è Watch-Ordner</span>
                                    </div>
                                    <p class="feature-toggle-desc">
                                        √úberwache Ordner und importiere neue Dateien automatisch.
                                    </p>
                                    <div id="wizardWatchFoldersConfig" class="feature-toggle-config" style="display: none;">
                                        <div class="wizard-form-group">
                                            <label for="wizardWatchFolderPath">Erster Watch-Ordner</label>
                                            <input type="text" id="wizardWatchFolderPath" class="form-control" 
                                                   placeholder="Ordner zum √úberwachen">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- MQTT Feature -->
                            <div class="feature-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="wizardMqttToggle">
                                    <span class="toggle-slider"></span>
                                </label>
                                <div class="feature-toggle-content">
                                    <div class="feature-toggle-header">
                                        <span class="feature-toggle-title">üì° MQTT Integration</span>
                                    </div>
                                    <p class="feature-toggle-desc">
                                        Verbinde mit Home Assistant √ºber MQTT f√ºr Automatisierung.
                                    </p>
                                    <div id="wizardMqttConfig" class="feature-toggle-config" style="display: none;">
                                        <div class="wizard-form-group">
                                            <label for="wizardMqttHost">MQTT Host *</label>
                                            <input type="text" id="wizardMqttHost" class="form-control" 
                                                   placeholder="z.B. homeassistant.local">
                                        </div>
                                        <div class="wizard-form-group">
                                            <label for="wizardMqttPort">MQTT Port</label>
                                            <input type="number" id="wizardMqttPort" class="form-control" 
                                                   value="1883" min="1" max="65535">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Summary -->
                    <div id="wizardStep5" class="wizard-step">
                        <h2 class="wizard-step-title">Zusammenfassung</h2>
                        <p class="wizard-step-subtitle">
                            √úberpr√ºfe deine Konfiguration bevor du die Einrichtung abschlie√üt.
                        </p>

                        <div class="summary-section">
                            <h4>üñ®Ô∏è Drucker</h4>
                            <div id="wizardSummaryPrinter">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <div class="summary-section">
                            <h4>üìÇ Pfade</h4>
                            <div id="wizardSummaryPaths">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <div class="summary-section">
                            <h4>‚ö° Features</h4>
                            <div id="wizardSummaryFeatures">
                                <!-- Filled by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wizard Footer/Navigation -->
                <div class="setup-wizard-footer">
                    <div class="wizard-nav-left">
                        <button type="button" id="wizardBtnBack" class="wizard-btn wizard-btn-secondary" style="display: none;">
                            <span>‚Üê</span> <span>Zur√ºck</span>
                        </button>
                    </div>
                    <div class="wizard-nav-right">
                        <button type="button" id="wizardBtnSkipAll" class="wizard-btn wizard-btn-skip" style="display: none;">
                            Assistent √ºberspringen
                        </button>
                        <button type="button" id="wizardBtnSkip" class="wizard-btn wizard-btn-skip" style="display: none;">
                            Schritt √ºberspringen
                        </button>
                        <button type="button" id="wizardBtnNext" class="wizard-btn wizard-btn-primary">
                            <span>Einrichtung starten</span> <span>‚Üí</span>
                        </button>
                        <button type="button" id="wizardBtnFinish" class="wizard-btn wizard-btn-primary" style="display: none;">
                            ‚úì Einrichtung abschlie√üen
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Setup Incomplete Banner -->
    <div id="setupIncompleteBanner" class="setup-incomplete-banner">
        <span>Setup nicht abgeschlossen</span>
        <button class="resume-btn">Setup fortsetzen</button>
        <button class="dismiss-btn">Sp√§ter</button>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <span class="footer-text">
                Printernizer v<span id="appVersion">...</span>
                <span id="updateStatus" class="update-status"></span>
            </span>
        </div>
    </footer>
</body>
</html>